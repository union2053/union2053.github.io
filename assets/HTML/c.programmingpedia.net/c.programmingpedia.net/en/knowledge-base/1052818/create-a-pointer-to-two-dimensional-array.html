<!DOCTYPE html>



<html lang="en" itemscope="" itemtype="http://schema.org/QAPage">

<!-- Mirrored from c.programmingpedia.net/en/knowledge-base/1052818/create-a-pointer-to-two-dimensional-array by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 16 Jan 2021 09:55:19 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <!-- webmaster tools -->
        <meta name="google-site-verification" content="" />
        <!-- Open Graph Tags -->
        <meta name="title" property="og:title" content="[SOLVED] Create a pointer to two-dimensional array | C Language Knowledge Base">
        <meta name="description" property="og:description" content="[SOLVED] Create a pointer to two-dimensional array | C Language Knowledge Base">
        <title>[SOLVED] Create a pointer to two-dimensional array | C Language Knowledge Base</title>

    

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    
        <style>
            body{margin:0;}img{max-width:100%;}ul{margin-top:0;margin-bottom:1rem;}.list-inline{padding-left:0;list-style:none;}.list-inline-item{display:inline-block;}.list-inline-item:not(:last-child){margin-right:.5rem;}.site-header{display:flex;height:60px;}.site-main,.site-footer{display:flex;}.col-aside-left-and-sidebar .col-aside-left,.col-sidebar,.col-content,.col-aside-right{position:relative;}.site-header .col-aside-left-and-sidebar-inner,.site-header .col-aside-right-inner,.site-header .col-content-inner{height:60px;}.site-header .col-aside-left-and-sidebar-inner,.site-header .col-aside-right-inner{position:fixed;z-index:1;}.site-main .col-aside-left-inner,.site-main .col-sidebar-inner,.site-main .col-aside-right-inner{height:calc(100vh - 60px);position:fixed;}.site-main .col-sidebar-overflow{height:calc(100vh - 60px);position:relative;overflow-x:hidden;overflow-y:auto;}.col-aside-left-and-sidebar,.col-aside-left-and-sidebar-inner{width:calc(50% - 450px);}.col-aside-left,.col-aside-left-inner{width:calc(50% - 750px);}.col-sidebar,.col-sidebar-inner{width:300px;}.col-content,.col-content-inner{width:1200px;}.col-aside-right,.col-aside-right-inner{width:calc(50% - 750px);}@media(max-width:1869px){.col-aside-left-and-sidebar,.col-aside-left-and-sidebar-inner{width:calc(50% - 500px);}.col-aside-left,.col-aside-left-inner{display:none;}.col-sidebar,.col-sidebar-inner{width:calc(50% - 500px);}.col-content,.col-content-inner{width:1000px;}.col-aside-right,.col-aside-right-inner{width:calc(50% - 500px);}}@media(max-width:1549px){.col-aside-left-and-sidebar,.col-aside-left-and-sidebar-inner{width:calc(50% - 400px);}.col-sidebar,.col-sidebar-inner{width:calc(50% - 400px);}.col-content,.col-content-inner{width:800px;}.col-aside-right,.col-aside-right-inner{width:calc(50% - 400px);}}@media(max-width:1229px){.col-aside-left-and-sidebar,.col-aside-left-and-sidebar-inner{width:300px;}.col-sidebar,.col-sidebar-inner{width:300px;}.col-content{width:calc(100% - 300px);}.col-content-inner{width:100%;}.col-aside-right,.col-aside-right-inner{display:none;}}@media(max-width:1000px){.col-aside-left-and-sidebar,.col-aside-left-and-sidebar-inner{width:250px;}.col-sidebar,.col-sidebar-inner{width:250px;}.col-content{width:calc(100% - 250px);}}@media(max-width:767px){.col-aside-left-and-sidebar,.col-aside-left-and-sidebar-inner{display:none;}.col-sidebar,.col-sidebar-inner{display:none;}.col-content{width:100%;}.site-main{display:initial;}.site-main .col-sidebar,.site-main .col-sidebar-inner{display:initial;width:100%;position:relative;}.site-main .col-sidebar-overflow{height:calc(30vh);}}.site-header .col-aside-left-and-sidebar-inner,.site-header .col-aside-right-inner,.site-header .col-content-inner{box-shadow:rgba(116,129,141,.1) 0 3px 8px 0;border-bottom:1px solid #d4dadf;}.site-header .col-aside-left-and-sidebar-inner,.site-header .col-aside-right-inner,.site-main .col-aside-left-inner,.site-main .col-sidebar-inner,.site-main .col-aside-right-inner{background:#f5f7f9 none repeat scroll 0% 0%;}.site-header .col-aside-left-and-sidebar-inner,.site-main .col-sidebar-inner{border-right:1px solid #e6ecf1;}.site-header .col-aside-right,.site-main .col-aside-right{border-left:1px solid #e6ecf1;}.brand{font-size:24px;font-weight:bold;height:100%;text-align:right;margin-right:20px;margin-top:10px;}
        </style>
    <link rel="stylesheet" type="text/css" href="../../../styles/master.min0e4d.css?v=todo">
    <!-- to fix/move? -->
    

    
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-55584370-32"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-131737769-1');
    </script>


</head>
<body>


<div class="site-header">
    <div class="col-aside-left-and-sidebar">
        <div class="col-aside-left-and-sidebar-inner">
            <div class="brand">
                <i class="fas fa-yin-yang" style="color: #0056b3;"></i>&nbsp;
                C Language Pedia
            </div>
        </div>
    </div>
    <div class="col-content">
        <div class="col-content-inner">
<div>
    <ul class="list-inline">
        <li class="list-inline-item"><a href="../../../index.html">Tutorial</a></li>
            <li class="list-inline-item"><a href="../../knowledge-base.html">Knowledge-Base</a></li>

            <li class="list-inline-item"><a href="../../awesome-learning/book.html">Awesome</a></li>
    </ul>
</div>

<style>
    .site-header .col-content .list-inline {
        padding-left: 20px;
        padding-top: 15px;

        font-weight: bold;
    }
</style>
        </div>
    </div>
    <div class="col-aside-right">
        <div class="col-aside-right-inner">
            
        </div>
    </div>
</div>
<div class="site-main">
    <div class="col-aside-left">
        <div class="col-aside-left-inner">
            
        </div>
    </div>
    <div class="col-sidebar">
        <div class="col-sidebar-inner">

            <div class="col-sidebar-overflow">
                
            </div>

        </div>
    </div>
    <div class="col-content">
        <div class="col-content-inner">
            


<div id="knowledge-base" class="kb-details">
    <div class="row">
        <div class="col-lg-1 col-xl-1">
        </div>
        <div class="col-lg-9 col-xl-9" itemprop="mainEntity" itemscope itemtype="http://schema.org/Question">
            <div class="container-h1">
                <h1 itemprop="name" id="create-a-pointer-to-two-dimensional-array">Create a pointer to two-dimensional array</h1>
                <div class="tag-list">
                        <span class="tag-item"><a href="../tag/arrays.html">arrays</a></span>
                        <span class="tag-item"><a href="../tag/c.html">c</a></span>
                        <span class="tag-item"><a href="../tag/pointers.html">pointers</a></span>
                </div>
            </div>
            <br>
            <div class="search-results-container">
                <div class="row">
                    <div class="col-sm-6">
                        <div class="block-question">
                            <div class="container-question">
                                <i class="fab fa-stack-overflow" style="font-size: 32px; position: absolute; left: -15px; top: -15px;"></i>
                                <h3 id="question">Question</h3>
                                <div itemprop="text">
                                    <p>I need a pointer to a static 2-dimensional array. How is this done?</p>

<pre><code>static uint8_t l_matrix[10][20];

void test(){
   uint8_t **matrix_ptr = l_matrix; //wrong idea 
}
</code></pre>

<p>I get all kinds of errors like:</p>

<ul>
<li>warning: assignment from incompatible pointer type</li>
<li>subscripted value is neither array nor pointer</li>
<li>error: invalid use of flexible array member</li>
</ul>

                                </div>

                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="profile-container">
                                        <div class="profile-details-container d-flex align-items-center">
                                            <div class="asker-name" itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="https://stackoverflow.com/users/126741/dill" target="_blank"><span itemprop="name">Dill</span></a></div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div style="display: none">
                                    <div itemprop="answerCount">1</div>
                                    <div itemprop="upvoteCount">109</div>
                                    <div itemprop="dateCreated">12/4/2012 12:32:02 PM</div>
                                </div>
                            </div>
                        </div>
                        
                        <br/>
                    </div>
                    <div class="col-sm-6">
                            <div id="answer-0" class="block-question answer" itemprop="acceptedAnswer" itemscope itemtype="http://schema.org/Answer">
                                <div class="container-question">
                                    <h3 id="accepted-answer">Accepted Answer</h3>
                                    <div itemprop="text">
                                        <p>Here you wanna make a pointer to the first element of the array</p>

<pre><code>uint8_t (*matrix_ptr)[20] = l_matrix;
</code></pre>

<p>With typedef, this looks cleaner</p>

<pre><code>typedef uint8_t array_of_20_uint8_t[20];
array_of_20_uint8_t *matrix_ptr = l_matrix;
</code></pre>

<p>Then you can enjoy life again :)</p>

<pre><code>matrix_ptr[0][1] = ...;
</code></pre>

<p>Beware of the <a href="https://stackoverflow.com/questions/274865/pointer-question-in-c/274943#274943">pointer/array world</a> in C, much confusion is around this.</p>

<hr>

<h3 id="edit">Edit</h3>

<p>Reviewing some of the other answers here, because the comment fields are too short to do there. Multiple alternatives were proposed, but it wasn't shown how they behave. Here is how they do</p>

<pre><code>uint8_t (*matrix_ptr)[][20] = l_matrix;
</code></pre>

<p>If you fix the error and add the address-of operator <code>&amp;</code> like in the following snippet</p>

<pre><code>uint8_t (*matrix_ptr)[][20] = &amp;l_matrix;
</code></pre>

<p>Then that one creates a pointer to an incomplete array type of elements of type array of 20 uint8_t. Because the pointer is to an array of arrays, you have to access it with</p>

<pre><code>(*matrix_ptr)[0][1] = ...;
</code></pre>

<p>And because it's a pointer to an incomplete array, you <em>cannot</em> do as a shortcut</p>

<pre><code>matrix_ptr[0][0][1] = ...;
</code></pre>

<p>Because indexing requires the element type's size to be known (indexing implies an addition of an integer to the pointer, so it won't work with incomplete types). Note that this only works in <code>C</code>, because <code>T[]</code> and <code>T[N]</code> are compatible types. C++ does not have a concept of <em>compatible types</em>, and so it will reject that code, because <code>T[]</code> and <code>T[10]</code> are different types. </p>

<hr>

<p>The following alternative doesn't work at all, because the element type of the array, when you view it as a one-dimensional array, is <em>not</em> <code>uint8_t</code>, but <code>uint8_t[20]</code></p>

<pre><code>uint8_t *matrix_ptr = l_matrix; // fail
</code></pre>

<hr>

<p>The following is a good alternative</p>

<pre><code>uint8_t (*matrix_ptr)[10][20] = &amp;l_matrix;
</code></pre>

<p>You access it with </p>

<pre><code>(*matrix_ptr)[0][1] = ...;
matrix_ptr[0][0][1] = ...; // also possible now
</code></pre>

<p>It has the benefit that it preserves the outer dimension's size. So you can apply sizeof on it</p>

<pre><code>sizeof (*matrix_ptr) == sizeof(uint8_t) * 10 * 20
</code></pre>

<hr>

<p>There is one other answer that makes use of the fact that items in an array are contiguously stored</p>

<pre><code>uint8_t *matrix_ptr = l_matrix[0];
</code></pre>

<p>Now, that formally only allows you to access the elements of the first element of the two dimensional array. That is, the following condition hold</p>

<pre><code>matrix_ptr[0] = ...; // valid
matrix_ptr[19] = ...; // valid

matrix_ptr[20] = ...; // undefined behavior
matrix_ptr[10*20-1] = ...; // undefined behavior
</code></pre>

<p>You will notice it probably works up to <code>10*20-1</code>, but if you throw on alias analysis and other aggressive optimizations, some compiler could make an assumption that may break that code. Having said that, i've never encountered a compiler that fails on it (but then again, i've not used that technique in real code), and even the C FAQ has that technique contained (with a warning about its UB'ness), and if you cannot change the array type, this is a last option to save you :)</p>

                                    </div>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div class="profile-container">
                                            <div class="profile-details-container d-flex align-items-center">
                                                    <div class="asker-name" itemprop="author" itemscope itemtype="https://schema.org/Person">
                                                        <a href="https://stackoverflow.com/users/34509/johannes-schaub---litb" target="_blank"><span itemprop="name">Johannes Schaub - litb</span></a>
                                                    </div>
                                            </div>
                                        </div>
                                    </div>
                                        <div style="display: none">
                                            <div itemprop="url">https://c.programmingpedia.net/en/knowledge-base/1052818/create-a-pointer-to-two-dimensional-array#answer-0</div>
                                            <div itemprop="upvoteCount">129</div>
                                            <div itemprop="dateCreated">5/23/2017 12:34:37 PM</div>
                                        </div>
                                </div>
                            </div>
                            <br/>
                            <div id="answer-1" class="block-question second-answer" >
                                <div class="container-question">
                                    <h3 id="popular-answer">Popular Answer</h3>
                                    <div >
                                        <p>To <em>fully</em> understand this, you <em>must</em> grasp the following concepts:</p>

<h2 id="arrays-are-not-pointers-">Arrays are not pointers!</h2>

<p>First of all (And it's been preached enough), <strong>arrays are not pointers</strong>. Instead, in most uses, they 'decay' to the address to their first element, which can be assigned to a pointer:</p>

<pre><code>int a[] = {1, 2, 3};

int *p = a; // p now points to a[0]
</code></pre>

<p>I assume it works this way so that the array's contents can be accessed without copying all of them. That's just a behavior of array types and is not meant to imply that they are same thing.</p>

<hr>

<hr>

<h2 id="multidimensional-arrays">Multidimensional arrays</h2>

<p>Multidimensional arrays are just a way to 'partition' memory in a way that the compiler/machine can understand and operate on.</p>

<p>For instance, <code>int a[4][3][5]</code> = an array containing 4*3*5 (60) 'chunks' of integer-sized memory.</p>

<p>The advantage over using <code>int a[4][3][5]</code> vs plain <code>int b[60]</code> is that they're now 'partitioned' (Easier to work with their 'chunks', if needed), and the program can now perform bound checking.</p>

<p>In fact, <code>int a[4][3][5]</code> is stored <em>exactly</em> like <code>int b[60]</code> in memory - The <em>only</em> difference is that the program now manages it as if they're separate entities of certain sizes (Specifically, four groups of three groups of five).</p>

<p>Keep in mind: Both <code>int a[4][3][5]</code> and <code>int b[60]</code> are the same in memory, and the only difference is how they're handled by the application/compiler</p>

<pre><code>{
  {1, 2, 3, 4, 5}
  {6, 7, 8, 9, 10}
  {11, 12, 13, 14, 15}
}
{
  {16, 17, 18, 19, 20}
  {21, 22, 23, 24, 25}
  {26, 27, 28, 29, 30}
}
{
  {31, 32, 33, 34, 35}
  {36, 37, 38, 39, 40}
  {41, 42, 43, 44, 45}
}
{
  {46, 47, 48, 49, 50}
  {51, 52, 53, 54, 55}
  {56, 57, 58, 59, 60}
}
</code></pre>

<p>From this, you can clearly see that each "partition" is just an array that the program keeps track of.</p>

<hr>

<hr>

<h2 id="syntax">Syntax</h2>

<p>Now, <strong>arrays are syntactically different from pointers</strong>. Specifically, this means <strong>the compiler/machine will treat them differently.</strong> This may seem like a no brainer, but take a look at this:</p>

<pre><code>int a[3][3];

printf("%p %p", a, a[0]);
</code></pre>

<p>The above example prints the same memory address twice, like this:</p>

<pre><code>0x7eb5a3b4 0x7eb5a3b4
</code></pre>

<p><strong>However, only one can be assigned to a pointer so directly</strong>:</p>

<pre><code>int *p1 = a[0]; // RIGHT !

int *p2 = a; // WRONG !
</code></pre>

<p><strong>Why can't</strong> <code>a</code> <strong>be assigned to a pointer but</strong> <code>a[0]</code> <strong>can?</strong></p>

<p>This, simply, is a consequence of multidimensional arrays, and I'll explain why:</p>

<p>At the level of '<code>a</code>', we still see that we have another 'dimension' to look forward to. At the level of '<code>a[0]</code>', however, we're already in the top dimension, so as far as the program is concerned we're just looking at a normal array.</p>

<p>You may be asking:</p>

<p><strong>Why does it matter if the array is multidimensional in regards to making a pointer for it?</strong></p>

<p>It's best to think this way:</p>

<p>A 'decay' from a multidimensional array is not just an address, but <em>an address with partition data</em> (AKA it still understands that its underlying data is made of other arrays), which consists of boundaries set by the array beyond the first dimension.</p>

<p>This 'partition' logic cannot exist within a pointer unless we specify it:</p>

<pre><code>int a[4][5][95][8];

int (*p)[5][95][8];

p = a; // p = *a[0] // p = a+0
</code></pre>

<p>Otherwise, the meaning of the array's sorting properties are lost.</p>

<p>Also note the use of parenthesis around <code>*p</code>: <code>int (*p)[5][95][8]</code> - That's to specify that we're making a pointer with these bounds, not an array of pointers with these bounds: <code>int *p[5][95][8]</code></p>

<hr>

<hr>

<h2 id="conclusion">Conclusion</h2>

<p>Let's review:</p>

<ul>
<li>Arrays decay to addresses if they have no other purpose in the used context</li>
<li>Multidimensional arrays are just arrays of arrays - Hence, the 'decayed' address will carry the burden of "I have sub dimensions"</li>
<li>Dimension data cannot exist in a pointer <em>unless you give it to it</em>.</li>
</ul>

<p>In brief: multidimensional arrays decay to addresses that carry the ability to understand their contents.</p>

                                    </div>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div class="profile-container">
                                            <div class="profile-details-container d-flex align-items-center">
                                                    <div class="asker-name"><a href="https://stackoverflow.com/users/3618920/super-cat" target="_blank">Super Cat</a></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <br/>
                    </div>
                </div>
                <div class="text-center mt-5 mb-5">
                    <a href="https://stackoverflow.com/questions/1052818" class="btn-only d-inline-block stack-overflow-identity" target="_blank"><i class="fab fa-stack-overflow"></i> View more on Stack Overflow</a>
                </div>
            </div>
            
            <div class="attribution">
                <div>Licensed under: <a href="https://creativecommons.org/licenses/by-sa/3.0/" target="_blank">CC-BY-SA</a> with <a href="https://stackoverflow.blog/2009/06/25/attribution-required/" target="_blank">attribution</a></div>
                <div>Not affiliated with: <a href="https://stackoverflow.com/questions/tagged/dapper" target="_blank">Stack Overflow</a></div>
                
            </div>
        </div>

    </div>
</div>
            
        </div>
    </div>
    <div class="col-aside-right">
        <div class="col-aside-right-inner">
        </div>
    </div>
</div>
<div class="site-footer">
</div>
    
    <a href="#" id="scroll-to-top" class="back-to-top" style="display: inline;">Icon</a>

<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="http://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

<script>
    $(function() {
        $('a').each(function() {
            var a = new RegExp('/' + window.location.host + '/');
            if (!a.test(this.href)) {
                $(this).attr("target", "_blank");
            }
        });

        $("table").addClass("table table-bordered table-hover table-responsive-sm table-striped");
        $("thead").addClass("thead-dark");

        $('aside a').each(function() {
            if ($(this).attr('href') == '/{{page.permalink}}' ||
                $(this).attr('href') == '{{ site.github.url }}/{{page.permalink}}') {
                $(this).addClass('font-weight-bold');
            }
        });
    });
</script>


</body>

<!-- Mirrored from c.programmingpedia.net/en/knowledge-base/1052818/create-a-pointer-to-two-dimensional-array by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 16 Jan 2021 09:55:19 GMT -->
</html>
