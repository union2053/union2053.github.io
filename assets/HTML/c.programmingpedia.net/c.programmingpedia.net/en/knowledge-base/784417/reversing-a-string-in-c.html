<!DOCTYPE html>



<html lang="en" itemscope="" itemtype="http://schema.org/QAPage">

<!-- Mirrored from c.programmingpedia.net/en/knowledge-base/784417/reversing-a-string-in-c by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 16 Jan 2021 09:27:41 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <!-- webmaster tools -->
        <meta name="google-site-verification" content="" />
        <!-- Open Graph Tags -->
        <meta name="title" property="og:title" content="[SOLVED] Reversing a string in C | C Language Knowledge Base">
        <meta name="description" property="og:description" content="[SOLVED] Reversing a string in C | C Language Knowledge Base">
        <title>[SOLVED] Reversing a string in C | C Language Knowledge Base</title>

    

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    
        <style>
            body{margin:0;}img{max-width:100%;}ul{margin-top:0;margin-bottom:1rem;}.list-inline{padding-left:0;list-style:none;}.list-inline-item{display:inline-block;}.list-inline-item:not(:last-child){margin-right:.5rem;}.site-header{display:flex;height:60px;}.site-main,.site-footer{display:flex;}.col-aside-left-and-sidebar .col-aside-left,.col-sidebar,.col-content,.col-aside-right{position:relative;}.site-header .col-aside-left-and-sidebar-inner,.site-header .col-aside-right-inner,.site-header .col-content-inner{height:60px;}.site-header .col-aside-left-and-sidebar-inner,.site-header .col-aside-right-inner{position:fixed;z-index:1;}.site-main .col-aside-left-inner,.site-main .col-sidebar-inner,.site-main .col-aside-right-inner{height:calc(100vh - 60px);position:fixed;}.site-main .col-sidebar-overflow{height:calc(100vh - 60px);position:relative;overflow-x:hidden;overflow-y:auto;}.col-aside-left-and-sidebar,.col-aside-left-and-sidebar-inner{width:calc(50% - 450px);}.col-aside-left,.col-aside-left-inner{width:calc(50% - 750px);}.col-sidebar,.col-sidebar-inner{width:300px;}.col-content,.col-content-inner{width:1200px;}.col-aside-right,.col-aside-right-inner{width:calc(50% - 750px);}@media(max-width:1869px){.col-aside-left-and-sidebar,.col-aside-left-and-sidebar-inner{width:calc(50% - 500px);}.col-aside-left,.col-aside-left-inner{display:none;}.col-sidebar,.col-sidebar-inner{width:calc(50% - 500px);}.col-content,.col-content-inner{width:1000px;}.col-aside-right,.col-aside-right-inner{width:calc(50% - 500px);}}@media(max-width:1549px){.col-aside-left-and-sidebar,.col-aside-left-and-sidebar-inner{width:calc(50% - 400px);}.col-sidebar,.col-sidebar-inner{width:calc(50% - 400px);}.col-content,.col-content-inner{width:800px;}.col-aside-right,.col-aside-right-inner{width:calc(50% - 400px);}}@media(max-width:1229px){.col-aside-left-and-sidebar,.col-aside-left-and-sidebar-inner{width:300px;}.col-sidebar,.col-sidebar-inner{width:300px;}.col-content{width:calc(100% - 300px);}.col-content-inner{width:100%;}.col-aside-right,.col-aside-right-inner{display:none;}}@media(max-width:1000px){.col-aside-left-and-sidebar,.col-aside-left-and-sidebar-inner{width:250px;}.col-sidebar,.col-sidebar-inner{width:250px;}.col-content{width:calc(100% - 250px);}}@media(max-width:767px){.col-aside-left-and-sidebar,.col-aside-left-and-sidebar-inner{display:none;}.col-sidebar,.col-sidebar-inner{display:none;}.col-content{width:100%;}.site-main{display:initial;}.site-main .col-sidebar,.site-main .col-sidebar-inner{display:initial;width:100%;position:relative;}.site-main .col-sidebar-overflow{height:calc(30vh);}}.site-header .col-aside-left-and-sidebar-inner,.site-header .col-aside-right-inner,.site-header .col-content-inner{box-shadow:rgba(116,129,141,.1) 0 3px 8px 0;border-bottom:1px solid #d4dadf;}.site-header .col-aside-left-and-sidebar-inner,.site-header .col-aside-right-inner,.site-main .col-aside-left-inner,.site-main .col-sidebar-inner,.site-main .col-aside-right-inner{background:#f5f7f9 none repeat scroll 0% 0%;}.site-header .col-aside-left-and-sidebar-inner,.site-main .col-sidebar-inner{border-right:1px solid #e6ecf1;}.site-header .col-aside-right,.site-main .col-aside-right{border-left:1px solid #e6ecf1;}.brand{font-size:24px;font-weight:bold;height:100%;text-align:right;margin-right:20px;margin-top:10px;}
        </style>
    <link rel="stylesheet" type="text/css" href="../../../styles/master.min0e4d.css?v=todo">
    <!-- to fix/move? -->
    

    
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-55584370-32"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-131737769-1');
    </script>


</head>
<body>


<div class="site-header">
    <div class="col-aside-left-and-sidebar">
        <div class="col-aside-left-and-sidebar-inner">
            <div class="brand">
                <i class="fas fa-yin-yang" style="color: #0056b3;"></i>&nbsp;
                C Language Pedia
            </div>
        </div>
    </div>
    <div class="col-content">
        <div class="col-content-inner">
<div>
    <ul class="list-inline">
        <li class="list-inline-item"><a href="../../../index.html">Tutorial</a></li>
            <li class="list-inline-item"><a href="../../knowledge-base.html">Knowledge-Base</a></li>

            <li class="list-inline-item"><a href="../../awesome-learning/book.html">Awesome</a></li>
    </ul>
</div>

<style>
    .site-header .col-content .list-inline {
        padding-left: 20px;
        padding-top: 15px;

        font-weight: bold;
    }
</style>
        </div>
    </div>
    <div class="col-aside-right">
        <div class="col-aside-right-inner">
            
        </div>
    </div>
</div>
<div class="site-main">
    <div class="col-aside-left">
        <div class="col-aside-left-inner">
            
        </div>
    </div>
    <div class="col-sidebar">
        <div class="col-sidebar-inner">

            <div class="col-sidebar-overflow">
                
            </div>

        </div>
    </div>
    <div class="col-content">
        <div class="col-content-inner">
            


<div id="knowledge-base" class="kb-details">
    <div class="row">
        <div class="col-lg-1 col-xl-1">
        </div>
        <div class="col-lg-9 col-xl-9" itemprop="mainEntity" itemscope itemtype="http://schema.org/Question">
            <div class="container-h1">
                <h1 itemprop="name" id="reversing-a-string-in-c">Reversing a string in C</h1>
                <div class="tag-list">
                        <span class="tag-item"><a href="../tag/c.html">c</a></span>
                        <span class="tag-item"><a href="../tag/pointers.html">pointers</a></span>
                        <span class="tag-item"><a href="../tag/string.html">string</a></span>
                </div>
            </div>
            <br>
            <div class="search-results-container">
                <div class="row">
                    <div class="col-sm-6">
                        <div class="block-question">
                            <div class="container-question">
                                <i class="fab fa-stack-overflow" style="font-size: 32px; position: absolute; left: -15px; top: -15px;"></i>
                                <h3 id="question">Question</h3>
                                <div itemprop="text">
                                    <p>I have developed a reverse-string program. I am wondering if there is a better way to do this, and if my code has any potential problems. I am looking to practice some advanced features of C. </p>

<pre><code>char* reverse_string(char *str)
{
    char temp;
    size_t len = strlen(str) - 1;
    size_t i;
    size_t k = len;

    for(i = 0; i &lt; len; i++)
    {
        temp = str[k];
        str[k] = str[i];
        str[i] = temp;
        k--;

        /* As 2 characters are changing place for each cycle of the loop
           only traverse half the array of characters */
        if(k == (len / 2))
        {
            break;
        }
    }
}
</code></pre>

                                </div>

                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="profile-container">
                                        <div class="profile-details-container d-flex align-items-center">
                                            <div class="asker-name" itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="https://stackoverflow.com/users/70942/ant2009" target="_blank"><span itemprop="name">ant2009</span></a></div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div style="display: none">
                                    <div itemprop="answerCount">1</div>
                                    <div itemprop="upvoteCount">34</div>
                                    <div itemprop="dateCreated">11/17/2016 6:07:30 PM</div>
                                </div>
                            </div>
                        </div>
                        
                        <br/>
                    </div>
                    <div class="col-sm-6">
                            <div id="answer-0" class="block-question answer" itemprop="acceptedAnswer" itemscope itemtype="http://schema.org/Answer">
                                <div class="container-question">
                                    <h3 id="accepted-answer">Accepted Answer</h3>
                                    <div itemprop="text">
                                        <p>If you want to practice advanced features of C, how about pointers?
We can toss in macros and xor-swap for fun too!</p>

<pre><code>#include &lt;string.h&gt; // for strlen()

// reverse the given null-terminated string in place
void inplace_reverse(char * str)
{
  if (str)
  {
    char * end = str + strlen(str) - 1;

    // swap the values in the two given variables
    // XXX: fails when a and b refer to same memory location
#   define XOR_SWAP(a,b) do\
    {\
      a ^= b;\
      b ^= a;\
      a ^= b;\
    } while (0)

    // walk inwards from both ends of the string, 
    // swapping until we get to the middle
    while (str &lt; end)
    {
      XOR_SWAP(*str, *end);
      str++;
      end--;
    }
#   undef XOR_SWAP
  }
}
</code></pre>

<p>A <strong>pointer</strong> (e.g. <code>char *</code>, read from right-to-left as a <em>pointer to a <code>char</code></em>) is a data type in C that is used
to refer to location in memory of another value.  In this case,
the location where a <code>char</code> is stored.  We can <em>dereference</em>
pointers by prefixing them with an <code>*</code>, which gives us the value
stored at that location.  So the value stored at <code>str</code> is <code>*str</code>.</p>

<p>We can do simple arithmetic with pointers.  When we increment (or decrement)
a pointer, we simply move it to refer to the next (or previous)
memory location for that type of value.  Incrementing pointers of
different types may move the pointer by a different number of
bytes because different values have different byte sizes in C.</p>

<p>Here, we use one pointer to refer to the first unprocessed
<code>char</code> of the string (<code>str</code>) and another to refer to the last (<code>end</code>).
We swap their values (<code>*str</code> and <code>*end</code>), and move the pointers
inwards to the middle of the string.  Once <code>str &gt;= end</code>, either
they both point to the same <code>char</code>, which means our original string had an
odd length (and the middle <code>char</code> doesn't need to be reversed), or
we've processed everything.</p>

<p>To do the swapping, I've defined a <strong>macro</strong>.  Macros are text substitution
done by the C preprocessor.  They are very different from functions,
and it's important to know the difference.  When you call a function,
the function operates on a copy of the values you give it.  When you call
a macro, it simply does a textual substitution - so the arguments you give
it are used directly.</p>

<p>Since I only used the <code>XOR_SWAP</code> macro once, it was probably overkill to define it,
but it made more clear what I was doing.  After the C preprocessor expands the macro,
the while loop looks like this:</p>

<pre><code>    while (str &lt; end)
    {
      do { *str ^= *end; *end ^= *str; *str ^= *end; } while (0);
      str++;
      end--;
    }
</code></pre>

<p>Note that the macro arguments show up once for each time they're used in the 
macro definition.   This can be very useful - but can also break your code
if used incorrectly.  For example, if I had compressed the increment/decrement
instructions and the macro call into a single line, like</p>

<pre><code>      XOR_SWAP(*str++, *end--);
</code></pre>

<p>Then this would expand to</p>

<pre><code>      do { *str++ ^= *end--; *end-- ^= *str++; *str++ ^= *end--; } while (0);
</code></pre>

<p>Which has <em>triple</em> the increment/decrement operations, and doesn't actually
do the swap it's supposed to do.</p>

<p>While we're on the subject, you should know what <strong>xor</strong> (<code>^</code>) means.  It's a basic
arithmetic operation - like addition, subtraction, multiplication, division, except
it's not usually taught in elementary school.  It combines two integers bit by bit
- like addition, but we don't care about the carry-overs.  <code>1^1 = 0</code>, <code>1^0 = 1</code>,
<code>0^1 = 1</code>, <code>0^0 = 0</code>.</p>

<p>A well known trick is to use xor to swap two values.  This works because of three basic
properties of xor: <code>x ^ 0 = x</code>, <code>x ^ x = 0</code> and <code>x ^ y = y ^ x</code> for all values <code>x</code> and <code>y</code>.  So say we have two
variables <code>a</code> and <code>b</code> that are initially storing two values
<code>v<sub>a</sub></code> and <code>v<sub>b</sub></code>.</p>

<pre>
  // initially:
  // a == v<sub>a</sub>
  // b == v<sub>b</sub>
  a ^= b;
  // now: a == v<sub>a</sub> ^ v<sub>b</sub>
  b ^= a;
  // now: b == v<sub>b</sub> ^ (v<sub>a</sub> ^ v<sub>b</sub>)
  //        == v<sub>a</sub> ^ (v<sub>b</sub> ^ v<sub>b</sub>)
  //        == v<sub>a</sub> ^ 0
  //        == v<sub>a</sub>
  a ^= b;
  // now: a == (v<sub>a</sub> ^ v<sub>b</sub>) ^ v<sub>a</sub>
  //        == (v<sub>a</sub> ^ v<sub>a</sub>) ^ v<sub>b</sub>
  //        == 0 ^ v<sub>b</sub>
  //        == v<sub>b</sub>
</pre>

<p>So the values are swapped.  This does have one bug - when <code>a</code> and <code>b</code> are the same variable:</p>

<pre>
  // initially:
  // a == v<sub>a</sub>
  a ^= a;
  // now: a == v<sub>a</sub> ^ v<sub>a</sub>
  //        == 0
  a ^= a;
  // now: a == 0 ^ 0
  //        == 0
  a ^= a;
  // now: a == 0 ^ 0
  //        == 0
</pre>

<p>Since we <code>str &lt; end</code>, this never happens in the above code, so we're okay.</p>

<p>While we're concerned about correctness we should check our edge cases.  The <code>if (str)</code> line should make sure we weren't given a <code>NULL</code> pointer for string.  What about the empty string <code>""</code>?  Well <code>strlen("") == 0</code>, so we'll initialize <code>end</code> as <code>str - 1</code>, which means that the <code>while (str &lt; end)</code> condition is never true, so we don't do anything.  Which is correct.</p>

<p>There's a bunch of C to explore.  Have fun with it!</p>

<p><strong>Update:</strong> <a href="https://stackoverflow.com/users/92202/mmw">mmw</a> brings up a good point, which is you do have to be slightly careful how you invoke this, as it does operate in-place.</p>

<pre><code> char stack_string[] = "This string is copied onto the stack.";
 inplace_reverse(stack_string);
</code></pre>

<p>This works fine, since <code>stack_string</code> is an array, whose contents are initialized to the given string constant.  However</p>

<pre><code> char * string_literal = "This string is part of the executable.";
 inplace_reverse(string_literal);
</code></pre>

<p>Will cause your code to flame and die at runtime.  That's because <code>string_literal</code> merely points to the string that is stored as part of your executable - which is normally memory that you are not allowed to edit by the OS.  In a happier world, your compiler would know this, and cough an error when you tried to compile, telling you that <code>string_literal</code> needs to be of type <code>char const *</code> since you can't modify the contents.  However, this is not the world my compiler lives in.</p>

<p>There are some hacks you could try to make sure that some memory is on the stack or in the heap (and is therefore editable), but they're not necessarily portable, and it could be pretty ugly.  However, I'm more than happy to throw responsibility for this to the function invoker.  I've told them that this function does in place memory manipulation, it's their responsibility to give me an argument that allows that.</p>

                                    </div>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div class="profile-container">
                                            <div class="profile-details-container d-flex align-items-center">
                                                    <div class="asker-name" itemprop="author" itemscope itemtype="https://schema.org/Person">
                                                        <a href="https://stackoverflow.com/users/9859/rampion" target="_blank"><span itemprop="name">rampion</span></a>
                                                    </div>
                                            </div>
                                        </div>
                                    </div>
                                        <div style="display: none">
                                            <div itemprop="url">https://c.programmingpedia.net/en/knowledge-base/784417/reversing-a-string-in-c#answer-0</div>
                                            <div itemprop="upvoteCount">61</div>
                                            <div itemprop="dateCreated">5/23/2017 10:31:25 AM</div>
                                        </div>
                                </div>
                            </div>
                            <br/>
                            <div id="answer-1" class="block-question second-answer" >
                                <div class="container-question">
                                    <h3 id="popular-answer">Popular Answer</h3>
                                    <div >
                                        <p>Just a rearrangement, and safety check. I also removed your non-used return type. I think this is a safe and clean as it gets:</p>

<pre><code>#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

void reverse_string(char *str)
{
    /* skip null */
    if (str == 0)
    {
        return;
    }

    /* skip empty string */
    if (*str == 0)
    {
        return;
    }

    /* get range */
    char *start = str;
    char *end = start + strlen(str) - 1; /* -1 for \0 */
    char temp;

    /* reverse */
    while (end &gt; start)
    {
        /* swap */
        temp = *start;
        *start = *end;
        *end = temp;

        /* move */
        ++start;
        --end;
    }
}


int main(void)
{
    char s1[] = "Reverse me!";
    char s2[] = "abc";
    char s3[] = "ab";
    char s4[] = "a";
    char s5[] = "";

    reverse_string(0);

    reverse_string(s1);
    reverse_string(s2);
    reverse_string(s3);
    reverse_string(s4);
    reverse_string(s5);

    printf("%s\n", s1);
    printf("%s\n", s2);
    printf("%s\n", s3);
    printf("%s\n", s4);
    printf("%s\n", s5);

    return 0;
}
</code></pre>

<p>Edited so that end will not point to a possibly bad memory location when strlen is 0.</p>

                                    </div>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div class="profile-container">
                                            <div class="profile-details-container d-flex align-items-center">
                                                    <div class="asker-name"><a href="https://stackoverflow.com/users/87234/gmannickg" target="_blank">GManNickG</a></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <br/>
                    </div>
                </div>
                <div class="text-center mt-5 mb-5">
                    <a href="https://stackoverflow.com/questions/784417" class="btn-only d-inline-block stack-overflow-identity" target="_blank"><i class="fab fa-stack-overflow"></i> View more on Stack Overflow</a>
                </div>
            </div>
            
            <div class="attribution">
                <div>Licensed under: <a href="https://creativecommons.org/licenses/by-sa/3.0/" target="_blank">CC-BY-SA</a> with <a href="https://stackoverflow.blog/2009/06/25/attribution-required/" target="_blank">attribution</a></div>
                <div>Not affiliated with: <a href="https://stackoverflow.com/questions/tagged/dapper" target="_blank">Stack Overflow</a></div>
                
            </div>
        </div>

    </div>
</div>
            
        </div>
    </div>
    <div class="col-aside-right">
        <div class="col-aside-right-inner">
        </div>
    </div>
</div>
<div class="site-footer">
</div>
    
    <a href="#" id="scroll-to-top" class="back-to-top" style="display: inline;">Icon</a>

<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="http://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

<script>
    $(function() {
        $('a').each(function() {
            var a = new RegExp('/' + window.location.host + '/');
            if (!a.test(this.href)) {
                $(this).attr("target", "_blank");
            }
        });

        $("table").addClass("table table-bordered table-hover table-responsive-sm table-striped");
        $("thead").addClass("thead-dark");

        $('aside a').each(function() {
            if ($(this).attr('href') == '/{{page.permalink}}' ||
                $(this).attr('href') == '{{ site.github.url }}/{{page.permalink}}') {
                $(this).addClass('font-weight-bold');
            }
        });
    });
</script>


</body>

<!-- Mirrored from c.programmingpedia.net/en/knowledge-base/784417/reversing-a-string-in-c by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 16 Jan 2021 09:27:41 GMT -->
</html>
