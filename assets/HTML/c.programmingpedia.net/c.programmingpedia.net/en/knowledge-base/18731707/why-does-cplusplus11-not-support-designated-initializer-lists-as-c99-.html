<!DOCTYPE html>



<html lang="en" itemscope="" itemtype="http://schema.org/QAPage">

<!-- Mirrored from c.programmingpedia.net/en/knowledge-base/18731707/why-does-cplusplus11-not-support-designated-initializer-lists-as-c99- by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 16 Jan 2021 10:07:49 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <!-- webmaster tools -->
        <meta name="google-site-verification" content="" />
        <!-- Open Graph Tags -->
        <meta name="title" property="og:title" content="[SOLVED] Why does C++11 not support designated initializer lists as C99? | C Language Knowledge Base">
        <meta name="description" property="og:description" content="[SOLVED] Why does C++11 not support designated initializer lists as C99? | C Language Knowledge Base">
        <title>[SOLVED] Why does C++11 not support designated initializer lists as C99? | C Language Knowledge Base</title>

    

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    
        <style>
            body{margin:0;}img{max-width:100%;}ul{margin-top:0;margin-bottom:1rem;}.list-inline{padding-left:0;list-style:none;}.list-inline-item{display:inline-block;}.list-inline-item:not(:last-child){margin-right:.5rem;}.site-header{display:flex;height:60px;}.site-main,.site-footer{display:flex;}.col-aside-left-and-sidebar .col-aside-left,.col-sidebar,.col-content,.col-aside-right{position:relative;}.site-header .col-aside-left-and-sidebar-inner,.site-header .col-aside-right-inner,.site-header .col-content-inner{height:60px;}.site-header .col-aside-left-and-sidebar-inner,.site-header .col-aside-right-inner{position:fixed;z-index:1;}.site-main .col-aside-left-inner,.site-main .col-sidebar-inner,.site-main .col-aside-right-inner{height:calc(100vh - 60px);position:fixed;}.site-main .col-sidebar-overflow{height:calc(100vh - 60px);position:relative;overflow-x:hidden;overflow-y:auto;}.col-aside-left-and-sidebar,.col-aside-left-and-sidebar-inner{width:calc(50% - 450px);}.col-aside-left,.col-aside-left-inner{width:calc(50% - 750px);}.col-sidebar,.col-sidebar-inner{width:300px;}.col-content,.col-content-inner{width:1200px;}.col-aside-right,.col-aside-right-inner{width:calc(50% - 750px);}@media(max-width:1869px){.col-aside-left-and-sidebar,.col-aside-left-and-sidebar-inner{width:calc(50% - 500px);}.col-aside-left,.col-aside-left-inner{display:none;}.col-sidebar,.col-sidebar-inner{width:calc(50% - 500px);}.col-content,.col-content-inner{width:1000px;}.col-aside-right,.col-aside-right-inner{width:calc(50% - 500px);}}@media(max-width:1549px){.col-aside-left-and-sidebar,.col-aside-left-and-sidebar-inner{width:calc(50% - 400px);}.col-sidebar,.col-sidebar-inner{width:calc(50% - 400px);}.col-content,.col-content-inner{width:800px;}.col-aside-right,.col-aside-right-inner{width:calc(50% - 400px);}}@media(max-width:1229px){.col-aside-left-and-sidebar,.col-aside-left-and-sidebar-inner{width:300px;}.col-sidebar,.col-sidebar-inner{width:300px;}.col-content{width:calc(100% - 300px);}.col-content-inner{width:100%;}.col-aside-right,.col-aside-right-inner{display:none;}}@media(max-width:1000px){.col-aside-left-and-sidebar,.col-aside-left-and-sidebar-inner{width:250px;}.col-sidebar,.col-sidebar-inner{width:250px;}.col-content{width:calc(100% - 250px);}}@media(max-width:767px){.col-aside-left-and-sidebar,.col-aside-left-and-sidebar-inner{display:none;}.col-sidebar,.col-sidebar-inner{display:none;}.col-content{width:100%;}.site-main{display:initial;}.site-main .col-sidebar,.site-main .col-sidebar-inner{display:initial;width:100%;position:relative;}.site-main .col-sidebar-overflow{height:calc(30vh);}}.site-header .col-aside-left-and-sidebar-inner,.site-header .col-aside-right-inner,.site-header .col-content-inner{box-shadow:rgba(116,129,141,.1) 0 3px 8px 0;border-bottom:1px solid #d4dadf;}.site-header .col-aside-left-and-sidebar-inner,.site-header .col-aside-right-inner,.site-main .col-aside-left-inner,.site-main .col-sidebar-inner,.site-main .col-aside-right-inner{background:#f5f7f9 none repeat scroll 0% 0%;}.site-header .col-aside-left-and-sidebar-inner,.site-main .col-sidebar-inner{border-right:1px solid #e6ecf1;}.site-header .col-aside-right,.site-main .col-aside-right{border-left:1px solid #e6ecf1;}.brand{font-size:24px;font-weight:bold;height:100%;text-align:right;margin-right:20px;margin-top:10px;}
        </style>
    <link rel="stylesheet" type="text/css" href="../../../styles/master.min0e4d.css?v=todo">
    <!-- to fix/move? -->
    

    
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-55584370-32"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-131737769-1');
    </script>


</head>
<body>


<div class="site-header">
    <div class="col-aside-left-and-sidebar">
        <div class="col-aside-left-and-sidebar-inner">
            <div class="brand">
                <i class="fas fa-yin-yang" style="color: #0056b3;"></i>&nbsp;
                C Language Pedia
            </div>
        </div>
    </div>
    <div class="col-content">
        <div class="col-content-inner">
<div>
    <ul class="list-inline">
        <li class="list-inline-item"><a href="../../../index.html">Tutorial</a></li>
            <li class="list-inline-item"><a href="../../knowledge-base.html">Knowledge-Base</a></li>

            <li class="list-inline-item"><a href="../../awesome-learning/book.html">Awesome</a></li>
    </ul>
</div>

<style>
    .site-header .col-content .list-inline {
        padding-left: 20px;
        padding-top: 15px;

        font-weight: bold;
    }
</style>
        </div>
    </div>
    <div class="col-aside-right">
        <div class="col-aside-right-inner">
            
        </div>
    </div>
</div>
<div class="site-main">
    <div class="col-aside-left">
        <div class="col-aside-left-inner">
            
        </div>
    </div>
    <div class="col-sidebar">
        <div class="col-sidebar-inner">

            <div class="col-sidebar-overflow">
                
            </div>

        </div>
    </div>
    <div class="col-content">
        <div class="col-content-inner">
            


<div id="knowledge-base" class="kb-details">
    <div class="row">
        <div class="col-lg-1 col-xl-1">
        </div>
        <div class="col-lg-9 col-xl-9" itemprop="mainEntity" itemscope itemtype="http://schema.org/Question">
            <div class="container-h1">
                <h1 itemprop="name" id="why-does-cplusplus11-not-support-designated-initializer-lists-as-c99-">Why does C++11 not support designated initializer lists as C99?</h1>
                <div class="tag-list">
                        <span class="tag-item"><a href="../tag/c.html">c</a></span>
                        <span class="tag-item"><a href="../tag/cplusplus.html">c++</a></span>
                        <span class="tag-item"><a href="../tag/cplusplus11.html">c++11</a></span>
                        <span class="tag-item"><a href="../tag/c99.html">c99</a></span>
                        <span class="tag-item"><a href="../tag/initialization.html">initialization</a></span>
                </div>
            </div>
            <br>
            <div class="search-results-container">
                <div class="row">
                    <div class="col-sm-6">
                        <div class="block-question">
                            <div class="container-question">
                                <i class="fab fa-stack-overflow" style="font-size: 32px; position: absolute; left: -15px; top: -15px;"></i>
                                <h3 id="question">Question</h3>
                                <div itemprop="text">
                                    <p>Consider:</p>

<pre><code>struct Person
{
    int height;
    int weight;
    int age;
};

int main()
{
    Person p { .age = 18 };
}
</code></pre>

<p>The code above is legal in C99, but not legal in C++11.</p>

<p><strong>What was the <a href="../../../questions/tagged/c%2b%2b11.html" class="post-tag" title="show questions tagged &#39;c++11&#39;" rel="tag">c++11</a> standard committee's rationale for excluding support for such a handy feature?</strong></p>

                                </div>

                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="profile-container">
                                        <div class="profile-details-container d-flex align-items-center">
                                            <div class="asker-name" itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="https://stackoverflow.com/users/508343/xmllmx" target="_blank"><span itemprop="name">xmllmx</span></a></div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div style="display: none">
                                    <div itemprop="answerCount">1</div>
                                    <div itemprop="upvoteCount">107</div>
                                    <div itemprop="dateCreated">9/10/2018 12:42:22 PM</div>
                                </div>
                            </div>
                        </div>
                        
                        <br/>
                    </div>
                    <div class="col-sm-6">
                            <div id="answer-0" class="block-question answer" itemprop="acceptedAnswer" itemscope itemtype="http://schema.org/Answer">
                                <div class="container-question">
                                    <h3 id="accepted-answer">Accepted Answer</h3>
                                    <div itemprop="text">
                                        <p>C++ has constructors. If it makes sense to initialize just one member then that can be expressed in the program by implementing an appropriate constructor. This is the sort of abstraction C++ promotes.</p>

<p>On the other hand the designated initializers feature is more about exposing and making members easy to access directly in client code. This leads to things like having a person of age 18 (years?) but with height and weight of zero.</p>

<hr>

<p>In other words, designated initializers support a programming style where internals are exposed, and the client is given flexibility to decide how they want to use the  type.</p>

<p>C++ is more interested in putting the flexibility on the side of the <strong><em>designer</em></strong> of a type instead, so designers can make it easy to use a type correctly and difficult to use incorrectly. Putting the designer in control of how a type can be initialized is part of this: the designer determines constructors, in-class initializers, etc.</p>

                                    </div>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div class="profile-container">
                                            <div class="profile-details-container d-flex align-items-center">
                                                    <div class="asker-name" itemprop="author" itemscope itemtype="https://schema.org/Person">
                                                        <a href="https://stackoverflow.com/users/365496/bames53" target="_blank"><span itemprop="name">bames53</span></a>
                                                    </div>
                                            </div>
                                        </div>
                                    </div>
                                        <div style="display: none">
                                            <div itemprop="url">https://c.programmingpedia.net/en/knowledge-base/18731707/why-does-cplusplus11-not-support-designated-initializer-lists-as-c99-#answer-0</div>
                                            <div itemprop="upvoteCount">29</div>
                                            <div itemprop="dateCreated">10/2/2015 2:25:58 AM</div>
                                        </div>
                                </div>
                            </div>
                            <br/>
                            <div id="answer-1" class="block-question second-answer" >
                                <div class="container-question">
                                    <h3 id="popular-answer">Popular Answer</h3>
                                    <div >
                                        <p>On July 15 '17 <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/p0329r4.pdf" rel="noreferrer">P0329R4</a> was accepted into the <a href="../../../questions/tagged/c%2b%2b20.html" class="post-tag" title="show questions tagged &#39;c++20&#39;" rel="tag">c++20</a> standard: <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/p0329r4.pdf" rel="noreferrer">http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/p0329r4.pdf</a><br>
This brings limited support for <a href="../../../questions/tagged/c99.html" class="post-tag" title="show questions tagged &#39;c99&#39;" rel="tag">c99</a>'s Designated Initializers. This limitation is described as follows by C.1.7[diff.decl].4, given:</p>

<pre><code>struct A { int x, y; };
struct B { struct A a; };
</code></pre>

<p>The following Designated Initializations, which are valid in C, are restricted in C++:</p>

<ul>
<li><code>struct A a = { .y = 1, .x = 2 }</code> is invalid in C++ because designators must appear in the declaration order of the data members</li>
<li><code>int arr[3] = { [1] = 5 }</code> is invalid in C++ because array designated initialization is not supported</li>
<li><code>struct B b = {.a.x = 0}</code> is invalid in C++ because designators cannot be nested</li>
<li><code>struct A c = {.x = 1, 2}</code> is invalid in C++ because either all or none of the data members must be initialized by designators</li>
</ul>

<hr>

<p>For <a href="../../../questions/tagged/c%2b%2b17.html" class="post-tag" title="show questions tagged &#39;c++17&#39;" rel="tag">c++17</a> and earlier Boost actually has <a href="http://www.boost.org/doc/libs/1_64_0/libs/parameter/doc/html/index.html" rel="noreferrer">support for Designated Intializers</a> and there have been numerous proposals to add support to the <a href="../../../questions/tagged/c%2b%2b.html" class="post-tag" title="show questions tagged &#39;c++&#39;" rel="tag">c++</a> standard, for example: <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4172.htm" rel="noreferrer">n4172</a> and <a href="http://htmlpreview.github.io/?https://raw.github.com/CTMacUser/multiarray-iso-proposal/master/designation-proposal.html" rel="noreferrer">Daryle Walker's Proposal to Add Designation to Initializers</a>. The proposals cite implementation of <a href="../../../questions/tagged/c99.html" class="post-tag" title="show questions tagged &#39;c99&#39;" rel="tag">c99</a>'s Designated Initializers in Visual C++, gcc, and Clang claiming:</p>

<blockquote>
  <p>We believe the changes will be relatively straightforward to implement</p>
</blockquote>

<p>But the standard committee repeatedly <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4327.html#150" rel="noreferrer">rejects such proposals</a>, stating:</p>

<blockquote>
  <p>EWG found various problems with the proposed approach, and didn't think it's feasible to try solving the problem, as it has been tried many times and every time it has failed</p>
</blockquote>

<p><a href="https://stackoverflow.com/questions/34614308/is-there-a-way-to-get-warned-about-misbehaving-designated-initializers?noredirect=1#comment57025198_34614308">Ben Voigt's comments</a> have helped me to see the insurmountable problems with this approach; given:</p>

<pre><code>struct X {
    int c;
    char a;
    float b;
};
</code></pre>

<p>What order would these functions be called in in <a href="../../../questions/tagged/c99.html" class="post-tag" title="show questions tagged &#39;c99&#39;" rel="tag">c99</a>: <code>struct X foo = {.a = (char)f(), .b = g(), .c = h()}</code>? Surprisingly, in <a href="../../../questions/tagged/c99.html" class="post-tag" title="show questions tagged &#39;c99&#39;" rel="tag">c99</a>:</p>

<blockquote>
  <p>The order of evaluation of the subexpressions in any initializer is indeterminately sequenced <sup>[<a href="http://en.cppreference.com/w/c/language/struct_initialization#Notes" rel="noreferrer">1</a>]</sup></p>
</blockquote>

<p>(Visual C++, <a href="http://ideone.com/WO3NEt" rel="noreferrer">gcc</a>, and Clang seem to have an agreed upon behavior as they will all make the calls in this order:) <strike></p>

<ol>
<li><code>h()</code></li>
<li><code>f()</code></li>
<li><code>g()</code></li>
</ol>

<p></strike> But the indeterminate nature of the standard means that if these functions had any interaction the resulting program state would also be indeterminate, <em>and the compiler wouldn't warn you</em>: <a href="https://stackoverflow.com/q/34614308/2642059">Is there a Way to Get Warned about Misbehaving Designated Initializers?</a></p>

<p><a href="../../../questions/tagged/c%2b%2b.html" class="post-tag" title="show questions tagged &#39;c++&#39;" rel="tag">c++</a> <em>does</em> have stringent initializer-list requirements 11.6.4[dcl.init.list]4:</p>

<blockquote>
  <p>Within the initializer-list of a braced-init-list, the initializer-clauses, including any that result from pack expansions (17.5.3), are evaluated in the order in which they appear. That is, every value computation and side eï¬€ect associated with a given initializer-clause is sequenced before every value computation and side effect associated with any initializer-clause that follows it in the comma-separated list of the initializer-list.</p>
</blockquote>

<p>So <a href="../../../questions/tagged/c%2b%2b.html" class="post-tag" title="show questions tagged &#39;c++&#39;" rel="tag">c++</a> support would have required this to be executed in the order:</p>

<ol>
<li><code>f()</code></li>
<li><code>g()</code></li>
<li><code>h()</code></li>
</ol>

<p>Breaking compatibility with previous <a href="../../../questions/tagged/c99.html" class="post-tag" title="show questions tagged &#39;c99&#39;" rel="tag">c99</a> implementations.<br>
As discussed above, this issue has been circumvented by the limitations on Designated Initializers accepted into <a href="../../../questions/tagged/c%2b%2b20.html" class="post-tag" title="show questions tagged &#39;c++20&#39;" rel="tag">c++20</a>. They provide a standardized behavior, guaranteeing the execution order of Designated Initializers.</p>

                                    </div>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div class="profile-container">
                                            <div class="profile-details-container d-flex align-items-center">
                                                    <div class="asker-name"><a href="https://stackoverflow.com/users/2642059/jonathan-mee" target="_blank">Jonathan Mee</a></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <br/>
                    </div>
                </div>
                <div class="text-center mt-5 mb-5">
                    <a href="https://stackoverflow.com/questions/18731707" class="btn-only d-inline-block stack-overflow-identity" target="_blank"><i class="fab fa-stack-overflow"></i> View more on Stack Overflow</a>
                </div>
            </div>
            
            <div class="attribution">
                <div>Licensed under: <a href="https://creativecommons.org/licenses/by-sa/3.0/" target="_blank">CC-BY-SA</a> with <a href="https://stackoverflow.blog/2009/06/25/attribution-required/" target="_blank">attribution</a></div>
                <div>Not affiliated with: <a href="https://stackoverflow.com/questions/tagged/dapper" target="_blank">Stack Overflow</a></div>
                
            </div>
        </div>

    </div>
</div>
            
        </div>
    </div>
    <div class="col-aside-right">
        <div class="col-aside-right-inner">
        </div>
    </div>
</div>
<div class="site-footer">
</div>
    
    <a href="#" id="scroll-to-top" class="back-to-top" style="display: inline;">Icon</a>

<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="http://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

<script>
    $(function() {
        $('a').each(function() {
            var a = new RegExp('/' + window.location.host + '/');
            if (!a.test(this.href)) {
                $(this).attr("target", "_blank");
            }
        });

        $("table").addClass("table table-bordered table-hover table-responsive-sm table-striped");
        $("thead").addClass("thead-dark");

        $('aside a').each(function() {
            if ($(this).attr('href') == '/{{page.permalink}}' ||
                $(this).attr('href') == '{{ site.github.url }}/{{page.permalink}}') {
                $(this).addClass('font-weight-bold');
            }
        });
    });
</script>


</body>

<!-- Mirrored from c.programmingpedia.net/en/knowledge-base/18731707/why-does-cplusplus11-not-support-designated-initializer-lists-as-c99- by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 16 Jan 2021 10:07:53 GMT -->
</html>
