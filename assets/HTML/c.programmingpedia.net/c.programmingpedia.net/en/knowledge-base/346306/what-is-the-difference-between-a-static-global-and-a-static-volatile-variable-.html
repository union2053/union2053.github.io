<!DOCTYPE html>



<html lang="en" itemscope="" itemtype="http://schema.org/QAPage">

<!-- Mirrored from c.programmingpedia.net/en/knowledge-base/346306/what-is-the-difference-between-a-static-global-and-a-static-volatile-variable- by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 16 Jan 2021 10:06:56 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <!-- webmaster tools -->
        <meta name="google-site-verification" content="" />
        <!-- Open Graph Tags -->
        <meta name="title" property="og:title" content="[SOLVED] What is the difference between a static global and a static volatile variable? | C Language Knowledge Base">
        <meta name="description" property="og:description" content="[SOLVED] What is the difference between a static global and a static volatile variable? | C Language Knowledge Base">
        <title>[SOLVED] What is the difference between a static global and a static volatile variable? | C Language Knowledge Base</title>

    

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    
        <style>
            body{margin:0;}img{max-width:100%;}ul{margin-top:0;margin-bottom:1rem;}.list-inline{padding-left:0;list-style:none;}.list-inline-item{display:inline-block;}.list-inline-item:not(:last-child){margin-right:.5rem;}.site-header{display:flex;height:60px;}.site-main,.site-footer{display:flex;}.col-aside-left-and-sidebar .col-aside-left,.col-sidebar,.col-content,.col-aside-right{position:relative;}.site-header .col-aside-left-and-sidebar-inner,.site-header .col-aside-right-inner,.site-header .col-content-inner{height:60px;}.site-header .col-aside-left-and-sidebar-inner,.site-header .col-aside-right-inner{position:fixed;z-index:1;}.site-main .col-aside-left-inner,.site-main .col-sidebar-inner,.site-main .col-aside-right-inner{height:calc(100vh - 60px);position:fixed;}.site-main .col-sidebar-overflow{height:calc(100vh - 60px);position:relative;overflow-x:hidden;overflow-y:auto;}.col-aside-left-and-sidebar,.col-aside-left-and-sidebar-inner{width:calc(50% - 450px);}.col-aside-left,.col-aside-left-inner{width:calc(50% - 750px);}.col-sidebar,.col-sidebar-inner{width:300px;}.col-content,.col-content-inner{width:1200px;}.col-aside-right,.col-aside-right-inner{width:calc(50% - 750px);}@media(max-width:1869px){.col-aside-left-and-sidebar,.col-aside-left-and-sidebar-inner{width:calc(50% - 500px);}.col-aside-left,.col-aside-left-inner{display:none;}.col-sidebar,.col-sidebar-inner{width:calc(50% - 500px);}.col-content,.col-content-inner{width:1000px;}.col-aside-right,.col-aside-right-inner{width:calc(50% - 500px);}}@media(max-width:1549px){.col-aside-left-and-sidebar,.col-aside-left-and-sidebar-inner{width:calc(50% - 400px);}.col-sidebar,.col-sidebar-inner{width:calc(50% - 400px);}.col-content,.col-content-inner{width:800px;}.col-aside-right,.col-aside-right-inner{width:calc(50% - 400px);}}@media(max-width:1229px){.col-aside-left-and-sidebar,.col-aside-left-and-sidebar-inner{width:300px;}.col-sidebar,.col-sidebar-inner{width:300px;}.col-content{width:calc(100% - 300px);}.col-content-inner{width:100%;}.col-aside-right,.col-aside-right-inner{display:none;}}@media(max-width:1000px){.col-aside-left-and-sidebar,.col-aside-left-and-sidebar-inner{width:250px;}.col-sidebar,.col-sidebar-inner{width:250px;}.col-content{width:calc(100% - 250px);}}@media(max-width:767px){.col-aside-left-and-sidebar,.col-aside-left-and-sidebar-inner{display:none;}.col-sidebar,.col-sidebar-inner{display:none;}.col-content{width:100%;}.site-main{display:initial;}.site-main .col-sidebar,.site-main .col-sidebar-inner{display:initial;width:100%;position:relative;}.site-main .col-sidebar-overflow{height:calc(30vh);}}.site-header .col-aside-left-and-sidebar-inner,.site-header .col-aside-right-inner,.site-header .col-content-inner{box-shadow:rgba(116,129,141,.1) 0 3px 8px 0;border-bottom:1px solid #d4dadf;}.site-header .col-aside-left-and-sidebar-inner,.site-header .col-aside-right-inner,.site-main .col-aside-left-inner,.site-main .col-sidebar-inner,.site-main .col-aside-right-inner{background:#f5f7f9 none repeat scroll 0% 0%;}.site-header .col-aside-left-and-sidebar-inner,.site-main .col-sidebar-inner{border-right:1px solid #e6ecf1;}.site-header .col-aside-right,.site-main .col-aside-right{border-left:1px solid #e6ecf1;}.brand{font-size:24px;font-weight:bold;height:100%;text-align:right;margin-right:20px;margin-top:10px;}
        </style>
    <link rel="stylesheet" type="text/css" href="../../../styles/master.min0e4d.css?v=todo">
    <!-- to fix/move? -->
    

    
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-55584370-32"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-131737769-1');
    </script>


</head>
<body>


<div class="site-header">
    <div class="col-aside-left-and-sidebar">
        <div class="col-aside-left-and-sidebar-inner">
            <div class="brand">
                <i class="fas fa-yin-yang" style="color: #0056b3;"></i>&nbsp;
                C Language Pedia
            </div>
        </div>
    </div>
    <div class="col-content">
        <div class="col-content-inner">
<div>
    <ul class="list-inline">
        <li class="list-inline-item"><a href="../../../index.html">Tutorial</a></li>
            <li class="list-inline-item"><a href="../../knowledge-base.html">Knowledge-Base</a></li>

            <li class="list-inline-item"><a href="../../awesome-learning/book.html">Awesome</a></li>
    </ul>
</div>

<style>
    .site-header .col-content .list-inline {
        padding-left: 20px;
        padding-top: 15px;

        font-weight: bold;
    }
</style>
        </div>
    </div>
    <div class="col-aside-right">
        <div class="col-aside-right-inner">
            
        </div>
    </div>
</div>
<div class="site-main">
    <div class="col-aside-left">
        <div class="col-aside-left-inner">
            
        </div>
    </div>
    <div class="col-sidebar">
        <div class="col-sidebar-inner">

            <div class="col-sidebar-overflow">
                
            </div>

        </div>
    </div>
    <div class="col-content">
        <div class="col-content-inner">
            


<div id="knowledge-base" class="kb-details">
    <div class="row">
        <div class="col-lg-1 col-xl-1">
        </div>
        <div class="col-lg-9 col-xl-9" itemprop="mainEntity" itemscope itemtype="http://schema.org/Question">
            <div class="container-h1">
                <h1 itemprop="name" id="what-is-the-difference-between-a-static-global-and-a-static-volatile-variable-">What is the difference between a static global and a static volatile variable?</h1>
                <div class="tag-list">
                        <span class="tag-item"><a href="../tag/c.html">c</a></span>
                        <span class="tag-item"><a href="../tag/global.html">global</a></span>
                        <span class="tag-item"><a href="../tag/interrupt.html">interrupt</a></span>
                        <span class="tag-item"><a href="../tag/static.html">static</a></span>
                        <span class="tag-item"><a href="../tag/volatile.html">volatile</a></span>
                </div>
            </div>
            <br>
            <div class="search-results-container">
                <div class="row">
                    <div class="col-sm-6">
                        <div class="block-question">
                            <div class="container-question">
                                <i class="fab fa-stack-overflow" style="font-size: 32px; position: absolute; left: -15px; top: -15px;"></i>
                                <h3 id="question">Question</h3>
                                <div itemprop="text">
                                    <p>I have used a static global variable and a static volatile variable in file scope,
<p> both are updated by an ISR and a main loop and main loop checks the value of the variable. <p>here during optimization neither the global variable nor the volatile variable are optimized. So instead of using a volatile variable a global variable solves the problem. 
<p>So is it good to use global variable instead of volatile?
<p>Any specific reason to use static volatile??
<p>Any example program would be appreciable.
<p>Thanks in advance..</p>

                                </div>

                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="profile-container">
                                        <div class="profile-details-container d-flex align-items-center">
                                            <div class="asker-name" itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="https://stackoverflow.com/users/31116/manoj-doubts" target="_blank"><span itemprop="name">Manoj Doubts</span></a></div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div style="display: none">
                                    <div itemprop="answerCount">1</div>
                                    <div itemprop="upvoteCount">28</div>
                                    <div itemprop="dateCreated">9/18/2013 2:47:08 PM</div>
                                </div>
                            </div>
                        </div>
                        
                        <br/>
                    </div>
                    <div class="col-sm-6">
                            <div id="answer-0" class="block-question answer" itemprop="acceptedAnswer" itemscope itemtype="http://schema.org/Answer">
                                <div class="container-question">
                                    <h3 id="accepted-answer">Accepted Answer</h3>
                                    <div itemprop="text">
                                        <p>They are different things. I'm not an expert in volatile semantics. But i think it makes sense what is described here.</p>

<h3 id="global">Global</h3>

<p>Global just means the identifier in question is declared at file-scope. There are different scopes, called  function (where goto-labels are defined in), ﬁle (where globals reside), block (where normal local variables reside), and function prototype (where function parameters reside). This concept just exist to structure the visibility of identifiers. It doesn't have anything to do with optimizations. </p>

<h3 id="static">Static</h3>

<p><code>static</code> is a storage duration (we won't look at that here) and a way to give a name declared within file scope internal linkage. This can be done for functions or objects only required within one translation unit. A typical example might be a <code>help</code> function printing out the accepted parameters, and which is only called from the <code>main</code> function defined in the same <code>.c</code> file. </p>

<p><strong>6.2.2/2</strong> in a C99 draft:</p>

<blockquote>
  <p>If the declaration of a ﬁle scope
  identiﬁer for an object or a function
  contains  the storage class speciﬁer
  static, the identiﬁer has internal
  linkage.</p>
</blockquote>

<p>Internal linkage means that the identifier is not visible outside the current translation unit (like the <code>help</code> function of above). </p>

<h3 id="volatile">Volatile</h3>

<p>Volatile is a different thing: (<strong>6.7.3/6</strong>)</p>

<blockquote>
  <p>An object that has volatile-qualiﬁed
  type may be modiﬁed in ways unknown to
  the implementation or have other
  unknown side effects. Therefore any
  expression referring to such an object
  shall be evaluated strictly according
  to the rules of the abstract machine,
  as described in 5.1.2.3. Furthermore,
  at every sequence point the value last
  stored in the object shall agree with
  that prescribed by the abstract
  machine, except as modiﬁed by the
  unknown factors mentioned
  previously.</p>
</blockquote>

<p>The Standard provides an excellent example for an example where <code>volatile</code> would be redundant (<strong>5.1.2.3/8</strong>):</p>

<blockquote>
  <p>An implementation might deﬁne a
  one-to-one correspondence between
  abstract and actual semantics: at
  every sequence point, the values of
  the actual objects would agree with
  those speciﬁed by the abstract
  semantics. The keyword <code>volatile</code>
  would then be redundant.</p>
</blockquote>

<p>Sequence points are points where the effect of side effects concerning the <em>abstract machine</em> are completed (i.e external conditions like memory cell values are not included). Between the right and the left of <code>&amp;&amp;</code> and <code>||</code>, after <code>;</code> and returning from a function call are sequence points for example. </p>

<p>The <em>abstract semantics</em> is what the compiler can deduce from seeing only the sequence of code within a particular program. Effects of optimizations are irrelevant here. <em>actual semantics</em> include the effect of side effects done by writing to objects (for example, changing of memory cells). Qualifying an object as volatile means one always gets the value of an object straight from memory ("as modified by the unknown factors"). The Standard doesn't mention threads anywhere, and if you must rely on the order of changes, or on atomicity of operations, you should use platform dependent ways to ensure that.</p>

<p>For an easy to understand overview, intel has a great article about it <a href="http://software.intel.com/en-us/blogs/2007/11/30/volatile-almost-useless-for-multi-threaded-programming/" rel="noreferrer">here</a>.</p>

<h3 id="what-should-i-do-now-">What should i do now?</h3>

<p>Keep declaring your file-scope (global) data as volatile. Global data in itself does not mean the variables' value will equal to the value stored in memory. And static does only make your objects local to the current translation unit (the current <code>.c</code> files and all other files #include'ed by it). </p>

                                    </div>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div class="profile-container">
                                            <div class="profile-details-container d-flex align-items-center">
                                                    <div class="asker-name" itemprop="author" itemscope itemtype="https://schema.org/Person">
                                                        <a href="https://stackoverflow.com/users/34509/johannes-schaub---litb" target="_blank"><span itemprop="name">Johannes Schaub - litb</span></a>
                                                    </div>
                                            </div>
                                        </div>
                                    </div>
                                        <div style="display: none">
                                            <div itemprop="url">https://c.programmingpedia.net/en/knowledge-base/346306/what-is-the-difference-between-a-static-global-and-a-static-volatile-variable-#answer-0</div>
                                            <div itemprop="upvoteCount">21</div>
                                            <div itemprop="dateCreated">12/6/2008 5:54:11 PM</div>
                                        </div>
                                </div>
                            </div>
                            <br/>
                            <div id="answer-1" class="block-question second-answer" >
                                <div class="container-question">
                                    <h3 id="popular-answer">Popular Answer</h3>
                                    <div >
                                        <p>First let me mention that a static global variable, is the same as a global variable, except that you are limiting the variable to the scope of the file.  I.e. you can't use this global variable in other files via the <code>extern</code> keyword. </p>

<p>So you can reduce your question to global variables vs volatile variables. </p>

<p><strong>Now onto volatile:</strong></p>

<p>Like <code>const</code>, <code>volatile</code> is a type modifier.</p>

<p>The <code>volatile</code> keyword was created to prevent compiler optimizations that may make code incorrect, specifically when there are asynchronous events.</p>

<p>Objects declared as <code>volatile</code> may not be used in certain optimizations.  </p>

<p>The system always reads the current true value of a volatile object at the point it is used, even if a previous instruction asked for a value from the same object. Also, the value of the object is written immediately on assignment.  That means there is no caching of a volatile variable into a CPU register. </p>

<p><a href="http://www.ddj.com/cpp/184403766" rel="noreferrer">Dr. Jobb's has a great article on volatile</a>.</p>

<p>Here is an example from the Dr. Jobb's article:</p>

<pre><code>class Gadget
{
public:
    void Wait()
    {
        while (!flag_)
        {
            Sleep(1000); // sleeps for 1000 milliseconds
        }
    }
    void Wakeup()
    {
        flag_ = true;
    }
    ...
private:
    bool flag_;
};
</code></pre>

<p>If the compiler sees that <code>Sleep()</code> is an external call, it will assume that <code>Sleep()</code> cannot possibly change the variable flag_'s value.  So the compiler may store the value of <code>flag_</code> in a register.  And in that case, it will never change.  But if another thread calls wakeup, the first thread is still reading from the CPU's register. <code>Wait()</code> will never wake-up.</p>

<p>So why not just never cache variables into registers and avoid the problem completely? 
It turns out that this optimization can really save you a lot of time overall.  So C/C++ allows you to explicitly disable it via the <code>volatile</code> keyword. </p>

<p>The fact above that <code>flag_</code> was a member variable, and not a global variable (nor static global) does not matter. The explanation after the example gives the correct reasoning even if you're dealing with global variables (and static global variables). </p>

<p>A common misconception is that declaring a variable <code>volatile</code> is sufficient to ensure thread safety. Operations on the variable are still not atomic, even though they are not "cached" in registers </p>

<p><strong>volatile with pointers:</strong></p>

<p>Volatile with pointers, works like const with pointers. </p>

<p>A variable of type <code>volatile int *</code> means that the variable that the pointer points to is volatile. </p>

<p>A variable of type <code>int * volatile</code> means that the pointer itself is volatile. </p>

                                    </div>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div class="profile-container">
                                            <div class="profile-details-container d-flex align-items-center">
                                                    <div class="asker-name"><a href="https://stackoverflow.com/users/3153/brian-r--bondy" target="_blank">Brian R. Bondy</a></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <br/>
                    </div>
                </div>
                <div class="text-center mt-5 mb-5">
                    <a href="https://stackoverflow.com/questions/346306" class="btn-only d-inline-block stack-overflow-identity" target="_blank"><i class="fab fa-stack-overflow"></i> View more on Stack Overflow</a>
                </div>
            </div>
            
            <div class="attribution">
                <div>Licensed under: <a href="https://creativecommons.org/licenses/by-sa/3.0/" target="_blank">CC-BY-SA</a> with <a href="https://stackoverflow.blog/2009/06/25/attribution-required/" target="_blank">attribution</a></div>
                <div>Not affiliated with: <a href="https://stackoverflow.com/questions/tagged/dapper" target="_blank">Stack Overflow</a></div>
                
            </div>
        </div>

    </div>
</div>
            
        </div>
    </div>
    <div class="col-aside-right">
        <div class="col-aside-right-inner">
        </div>
    </div>
</div>
<div class="site-footer">
</div>
    
    <a href="#" id="scroll-to-top" class="back-to-top" style="display: inline;">Icon</a>

<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="http://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

<script>
    $(function() {
        $('a').each(function() {
            var a = new RegExp('/' + window.location.host + '/');
            if (!a.test(this.href)) {
                $(this).attr("target", "_blank");
            }
        });

        $("table").addClass("table table-bordered table-hover table-responsive-sm table-striped");
        $("thead").addClass("thead-dark");

        $('aside a').each(function() {
            if ($(this).attr('href') == '/{{page.permalink}}' ||
                $(this).attr('href') == '{{ site.github.url }}/{{page.permalink}}') {
                $(this).addClass('font-weight-bold');
            }
        });
    });
</script>


</body>

<!-- Mirrored from c.programmingpedia.net/en/knowledge-base/346306/what-is-the-difference-between-a-static-global-and-a-static-volatile-variable- by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 16 Jan 2021 10:06:56 GMT -->
</html>
