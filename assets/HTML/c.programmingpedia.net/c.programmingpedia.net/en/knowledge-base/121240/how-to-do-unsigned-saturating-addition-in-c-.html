<!DOCTYPE html>



<html lang="en" itemscope="" itemtype="http://schema.org/QAPage">

<!-- Mirrored from c.programmingpedia.net/en/knowledge-base/121240/how-to-do-unsigned-saturating-addition-in-c- by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 16 Jan 2021 09:23:16 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <!-- webmaster tools -->
        <meta name="google-site-verification" content="" />
        <!-- Open Graph Tags -->
        <meta name="title" property="og:title" content="[SOLVED] How to do unsigned saturating addition in C? | C Language Knowledge Base">
        <meta name="description" property="og:description" content="[SOLVED] How to do unsigned saturating addition in C? | C Language Knowledge Base">
        <title>[SOLVED] How to do unsigned saturating addition in C? | C Language Knowledge Base</title>

    

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    
        <style>
            body{margin:0;}img{max-width:100%;}ul{margin-top:0;margin-bottom:1rem;}.list-inline{padding-left:0;list-style:none;}.list-inline-item{display:inline-block;}.list-inline-item:not(:last-child){margin-right:.5rem;}.site-header{display:flex;height:60px;}.site-main,.site-footer{display:flex;}.col-aside-left-and-sidebar .col-aside-left,.col-sidebar,.col-content,.col-aside-right{position:relative;}.site-header .col-aside-left-and-sidebar-inner,.site-header .col-aside-right-inner,.site-header .col-content-inner{height:60px;}.site-header .col-aside-left-and-sidebar-inner,.site-header .col-aside-right-inner{position:fixed;z-index:1;}.site-main .col-aside-left-inner,.site-main .col-sidebar-inner,.site-main .col-aside-right-inner{height:calc(100vh - 60px);position:fixed;}.site-main .col-sidebar-overflow{height:calc(100vh - 60px);position:relative;overflow-x:hidden;overflow-y:auto;}.col-aside-left-and-sidebar,.col-aside-left-and-sidebar-inner{width:calc(50% - 450px);}.col-aside-left,.col-aside-left-inner{width:calc(50% - 750px);}.col-sidebar,.col-sidebar-inner{width:300px;}.col-content,.col-content-inner{width:1200px;}.col-aside-right,.col-aside-right-inner{width:calc(50% - 750px);}@media(max-width:1869px){.col-aside-left-and-sidebar,.col-aside-left-and-sidebar-inner{width:calc(50% - 500px);}.col-aside-left,.col-aside-left-inner{display:none;}.col-sidebar,.col-sidebar-inner{width:calc(50% - 500px);}.col-content,.col-content-inner{width:1000px;}.col-aside-right,.col-aside-right-inner{width:calc(50% - 500px);}}@media(max-width:1549px){.col-aside-left-and-sidebar,.col-aside-left-and-sidebar-inner{width:calc(50% - 400px);}.col-sidebar,.col-sidebar-inner{width:calc(50% - 400px);}.col-content,.col-content-inner{width:800px;}.col-aside-right,.col-aside-right-inner{width:calc(50% - 400px);}}@media(max-width:1229px){.col-aside-left-and-sidebar,.col-aside-left-and-sidebar-inner{width:300px;}.col-sidebar,.col-sidebar-inner{width:300px;}.col-content{width:calc(100% - 300px);}.col-content-inner{width:100%;}.col-aside-right,.col-aside-right-inner{display:none;}}@media(max-width:1000px){.col-aside-left-and-sidebar,.col-aside-left-and-sidebar-inner{width:250px;}.col-sidebar,.col-sidebar-inner{width:250px;}.col-content{width:calc(100% - 250px);}}@media(max-width:767px){.col-aside-left-and-sidebar,.col-aside-left-and-sidebar-inner{display:none;}.col-sidebar,.col-sidebar-inner{display:none;}.col-content{width:100%;}.site-main{display:initial;}.site-main .col-sidebar,.site-main .col-sidebar-inner{display:initial;width:100%;position:relative;}.site-main .col-sidebar-overflow{height:calc(30vh);}}.site-header .col-aside-left-and-sidebar-inner,.site-header .col-aside-right-inner,.site-header .col-content-inner{box-shadow:rgba(116,129,141,.1) 0 3px 8px 0;border-bottom:1px solid #d4dadf;}.site-header .col-aside-left-and-sidebar-inner,.site-header .col-aside-right-inner,.site-main .col-aside-left-inner,.site-main .col-sidebar-inner,.site-main .col-aside-right-inner{background:#f5f7f9 none repeat scroll 0% 0%;}.site-header .col-aside-left-and-sidebar-inner,.site-main .col-sidebar-inner{border-right:1px solid #e6ecf1;}.site-header .col-aside-right,.site-main .col-aside-right{border-left:1px solid #e6ecf1;}.brand{font-size:24px;font-weight:bold;height:100%;text-align:right;margin-right:20px;margin-top:10px;}
        </style>
    <link rel="stylesheet" type="text/css" href="../../../styles/master.min0e4d.css?v=todo">
    <!-- to fix/move? -->
    

    
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-55584370-32"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-131737769-1');
    </script>


</head>
<body>


<div class="site-header">
    <div class="col-aside-left-and-sidebar">
        <div class="col-aside-left-and-sidebar-inner">
            <div class="brand">
                <i class="fas fa-yin-yang" style="color: #0056b3;"></i>&nbsp;
                C Language Pedia
            </div>
        </div>
    </div>
    <div class="col-content">
        <div class="col-content-inner">
<div>
    <ul class="list-inline">
        <li class="list-inline-item"><a href="../../../index.html">Tutorial</a></li>
            <li class="list-inline-item"><a href="../../knowledge-base.html">Knowledge-Base</a></li>

            <li class="list-inline-item"><a href="../../awesome-learning/book.html">Awesome</a></li>
    </ul>
</div>

<style>
    .site-header .col-content .list-inline {
        padding-left: 20px;
        padding-top: 15px;

        font-weight: bold;
    }
</style>
        </div>
    </div>
    <div class="col-aside-right">
        <div class="col-aside-right-inner">
            
        </div>
    </div>
</div>
<div class="site-main">
    <div class="col-aside-left">
        <div class="col-aside-left-inner">
            
        </div>
    </div>
    <div class="col-sidebar">
        <div class="col-sidebar-inner">

            <div class="col-sidebar-overflow">
                
            </div>

        </div>
    </div>
    <div class="col-content">
        <div class="col-content-inner">
            


<div id="knowledge-base" class="kb-details">
    <div class="row">
        <div class="col-lg-1 col-xl-1">
        </div>
        <div class="col-lg-9 col-xl-9" itemprop="mainEntity" itemscope itemtype="http://schema.org/Question">
            <div class="container-h1">
                <h1 itemprop="name" id="how-to-do-unsigned-saturating-addition-in-c-">How to do unsigned saturating addition in C?</h1>
                <div class="tag-list">
                        <span class="tag-item"><a href="../tag/algorithm.html">algorithm</a></span>
                        <span class="tag-item"><a href="../tag/c.html">c</a></span>
                        <span class="tag-item"><a href="../tag/performance.html">performance</a></span>
                        <span class="tag-item"><a href="../tag/saturation-arithmetic.html">saturation-arithmetic</a></span>
                        <span class="tag-item"><a href="../tag/signal-processing.html">signal-processing</a></span>
                </div>
            </div>
            <br>
            <div class="search-results-container">
                <div class="row">
                    <div class="col-sm-6">
                        <div class="block-question">
                            <div class="container-question">
                                <i class="fab fa-stack-overflow" style="font-size: 32px; position: absolute; left: -15px; top: -15px;"></i>
                                <h3 id="question">Question</h3>
                                <div itemprop="text">
                                    <p>What is the best (cleanest, most efficient) way to write saturating addition in C?</p>

<p>The function or macro should add two unsigned inputs (need both 16- and 32-bit versions) and return all-bits-one (0xFFFF or 0xFFFFFFFF) if the sum overflows.</p>

<p>Target is x86 and ARM using gcc (4.1.2) and Visual Studio (for simulation only, so a fallback implementation is OK there).</p>

                                </div>

                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="profile-container">
                                        <div class="profile-details-container d-flex align-items-center">
                                            <div class="asker-name" itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="https://stackoverflow.com/users/8964/frank-szczerba" target="_blank"><span itemprop="name">Frank Szczerba</span></a></div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div style="display: none">
                                    <div itemprop="answerCount">1</div>
                                    <div itemprop="upvoteCount">40</div>
                                    <div itemprop="dateCreated">6/10/2019 5:24:52 PM</div>
                                </div>
                            </div>
                        </div>
                        
                        <br/>
                    </div>
                    <div class="col-sm-6">
                            <div id="answer-0" class="block-question answer" itemprop="acceptedAnswer" itemscope itemtype="http://schema.org/Answer">
                                <div class="container-question">
                                    <h3 id="accepted-answer">Accepted Answer</h3>
                                    <div itemprop="text">
                                        <p>You probably want portable <code>C</code> code here, which your compiler will turn into proper ARM assembly. ARM has conditional moves, and these can be conditional on overflow. The algorithm then becomes add, and conditionally set the destination to unsigned(-1) if overflow was detected.</p>

<pre><code>uint16_t add16(uint16_t a, uint16_t b)
{
  uint16_t c = a + b;
  if (c&lt;a) /* Can only happen due to overflow */
    c = -1;
  return c;
}
</code></pre>

<p>Note that this differs from the other algorithms in that it corrects overflow, instead of relying on another calculation to detect overflow.</p>

<p><a href="https://gcc.godbolt.org/#%7B%22version%22%3A3%2C%22filterAsm%22%3A%7B%22labels%22%3Atrue%2C%22directives%22%3Atrue%2C%22commentOnly%22%3Atrue%2C%22intel%22%3Atrue%7D%2C%22compilers%22%3A%5B%7B%22sourcez%22%3A%22MQSwdgxgNgrgJgUwAQB4DOAXO4MDoAWAfAFCgBmSAjEjQPS1IgQRICGAbgPYhxpIQBbTuyQB3EBnxJJCNMnBIBaVlAwIATmgDkSdhrQhOYUojLhkUEAGsEUAJ4AKAB4BKGu5oB9TwCMYIVXBPBCcABwQIDAcAQmjnFwAaKhcTBDMwZBgwSxt7eI8kbz8AjCCQ8MiYuNckgAYU4Fs5VPSLa1tHVwKaJxbzJCycjvyPXsawbDJiYnokAGVOdTU4RjAkRcR1dYooBFZMJB9WFaMkJwAOADYk8UkkAHNmAFZp%2FzAMSkvPDDY4Xk%2FPEoVGpNA43h8vj9WElwQCfj43ABvYg0WGQ%2FhIAC8bCQAGpDgBuFGMCgOCAoVhuWgAKiQAGFWGsjPYkPhWKFwms4DBkBhOOs9OoyFBOKIkNTaMSaCxsQBaShEmjqBAYGDqNYQIkAX2I4IAzAAmb6%2FXiGwHKVT6ME4M1QmE2o3wpHE%2FWOjHY1h4wnEkCk8mUpA0%2BmM9bZOys9mcpDc3n84QaYWi8WSjwypDyxVIZWq9X8bXTcjRtLmFYObwgPVXbxuAA%2BNaLrVL3guX0uABZqzMGAAVADyABFewAuJC7H4yficAShAIaJBWMBJySscf4ZCccLqRm8NjK1YgiBssD3PY%2BXbTWY8PZQFmHiJWQqeECXKueJBkRb8ITsJJ%2BVcrrQ%2BGZcNTBLd9PxDVhIhgFRGBfS5pFYdQTwwJJFx%2BBBcHuXAIzQURbCgXUHWNY5TSNFtPFCAArCBAWEa13ltNh7UYt0EWIRE6AYNB8EWEF%2BHUCQmBUWVQhXKQoBXBBIHDHxwyMZAIDsaBeSPaQ1yQNAfB8XR9EMYwPFdY0MGnLF0wVKVuis9xZk4gBBbsADJuw8esAEl3lsJAtRoNA7HeVgnDYS11RXEA9DQHCkG7DTOBkLZBQMIw%2BFuXiYFXEA%2BDEAIoEOZVWAfVL0wEfYBExHBbEs0qkAcAAiUiCk4gBSABtHwAF0Ela1h2vcetus6mhWo67yAB0wFGjBassgpasEYRIBoZqWp6rqWt4DBev69bME6gbvOm6ykBHHbNqQWrcXUWqapM0JEiQFbeouxyrpqykZo8E6Rtq%2B5rocBFAwYGA5HO9QBAQa6Py2T12x8CRdM0fSkgMSB5B%2BTAcoGOQ%2BENOH0ZAe4wFlEI1AmBAVhAARwewKSPpshhF34EVtP0OmaBcTMlRVNU1lu%2FMjKhP40DNCjqNorSfAYjAmOhAZiKdDiuM0kqbznCBOEQWUDAALwQX90tHIwTy2CBBNKCARLEu5JNJpSarbFhTgACX2fCbySPVHbWOyAFl%2BzYCYkAAIXUThjjdqBaDmKw7EkmwUnpzTtMYIDeY002hIt3KrfwGFsnaRRhHMqKJYDlZ5pEJDVOQZRwdHKSZNDYLcrpAAFABVNApVmUva71vvo04WQwC0eF8ofCdEE5RBG9OCdOCgFZ2BUHltmjA5TkZcMYPUQ8kBCCAEFCH5ff7SyBekadObYNABBq%2Bq%2FgKYbBoG8bJsO6zatLjxWo2l%2FTvam%2FKabNzqfifo9JIv9dofysidP%2B51MSvQcLde6j1zq4hen9d6R0vpPV%2BjVdiR0OaWWzDzS%2BoR%2BbyxNMLciVYxZPjAKESSh8pYyxYtLNiKROJKwtmsZUwNq6aVYHXeUWYED3EyiCfWPxeGjyQKEUO3JD7qWQMqNAMBVCrBxBkMUyoJGYA0FVW%2B98GpIGfpAx6QCYHdDmt%2BFgrVlCbQsT1axBQTo9XQZgt6CdrK4POvg%2F6qDHFPSQfKKkDB1YaJWAIgOoMBDXXVmATAW4cBNxasE6RhtjjgHuOZd8oc77gyEOocMmVowwAED4ZG%2FJMAbiZoyXJZACmaV4nFHJjAMByCgBQBQE4PxxRAcQjwpDcysHzOMSYrwkkEwyCsRxaopKeFIp4cEngbDsHAGCaZhNyZnDzgYHZKw7DOg8L6GqdhCDtzcgAOW7GaH2dkAAasougjLWFc259ynnXzeWcXEdhKHvDhEIv4AJlRCClsC2WaJjSEPcJxX5DhPSECQLUJwAAxTF6L0yHDcAAflRRirFx0cT4h8ASbyrwqHKD%2BGacFnBWFumhVQuFS0xE5jWEipAKK0VYr5di2UuKkAEt5fyzFJLPRkoJDqaYRFWLGhpXAOljKSLsKYgDbhswmlTiQAAJVwOfHA7YFVmSlsajALhWC4nJSQ7muZZQODQIQQghpaw1QFi4NA%2BY%2BgZBBXAT4SLfxuHdTgOELgHA1RVRapFLhcRRvDQiNwPKnBkFTRQEVKa00kocDGuNiaUgX0VWaDcUbmJy3lU6JACK7Wco9RGnN4JzXhspHGxtHZo2Ju5YStNPb03dt7am7NubAkuA5pSi8QMwBQ1VGAKSt4pwzl2HwPk0hRD8kSdgUoRhYI%2BC3JANcQETbflkL%2BCIrAYnq2nLOTQg8R4%2FHuKHCe%2BBMpyo4QqlcCy1BLNpUaOAJ53glNLcyitQrkSGWpRUsykrvSnNJI6yDKA2C1nrPBu%2BiHE1s1%2BQAPwbfLFw9Rr5NAQJhmtmkKnakDLSeZW4v2kUNMmV9wLqOLNIgCP90kMCAZhXactEJYUnPcNxsjd8PRehtbByN6i0NIaQHWGqUnUC4p8d0bDuGgWQnw0M9wRGSMcuExRoMzHaOgoQhKWVXZooHuQP%2BjQUlWSLEEmeRSGtkBDgcBZuYAB1OyuqkDnC0YaV9TE5grjsn8du2zZnnE8F5nzngwABDQKWpwaq3THKrS6alMySpoAfNiNF5xaiFeK7UTMF8MC1FNeGAAemcNwjlNLZf2FYMrVCPhVaQA1roDWDlgByy14kQVHLYiw71%2FrmZwzDaQKNpruXMxBVxNiAFxJ2s1mxBVzrZxMztexMg6gKBEOUDcIKvb3KUUAHYtOIqCrVirbqPiArfT8ELGAwtwAi718mZoEtQD4Ml1Lxp0tgd40xMbzWzIFdqFD6HpXMsgY27tmrdXNtg7m3Dp70hqCI8291xrhNxuDc6yN1HA2aCTeJ7N0nZw8RLe29QNb0hKtdbp6a9rB3kg4tO86pAeojuZmu0gW79RZOY%2B9RZz7cyP00f0sQLLhzPCKs8C7MAi44BUQQA4KhssWUuGBzQCDIm2DWuvlQ%2BMQoRRil20i6rUmXCOX%2Bjbipo7nW85%2BaRhwZvEyiAO7zlw1XUPc494KL3jlffEJlakkqmzdc6iAAAA%22%2C%22compiler%22%3A%22g530%22%2C%22options%22%3A%22-xc%20-Wall%20-fverbose-asm%20%20-O3%20-mtune%3Dhaswell%22%7D%5D%7D" rel="nofollow noreferrer">x86-64 clang 3.7 -O3 output for adds32</a>: significantly better than any other answer:</p>

<pre><code>    add     edi, esi
    mov     eax, -1
    cmovae  eax, edi
    ret
</code></pre>

<p><a href="https://gcc.godbolt.org/#%7B%22version%22%3A3%2C%22filterAsm%22%3A%7B%22labels%22%3Atrue%2C%22directives%22%3Atrue%2C%22commentOnly%22%3Atrue%7D%2C%22compilers%22%3A%5B%7B%22sourcez%22%3A%22MQSwdgxgNgrgJgUwAQB4DOAXO4MDoAWAfAFCgBmSAjEjQPS1IgQRICGAbgPYhxpIQBbTuyQB3EBnxJJCNMnBIBaVlAwIATmgDkSdhrQhOYUojLhkUEAGsEUAJ4AKAB4BKGu5oB9TwCMYIVXBPBCcABwQIDAcAQmjnFwAaKhcTBDMwZBgwSxt7eI8kbz8AjCCQ8MiYuNckgAYU4Fs5VPSLa1tHVwKaJxbzJCycjvyPXsawbDJiYnokAGVOdTU4RjAkRcR1dYooBFZMJB9WFaMkJwAOADYk8UkkAHNmAFZp%2FzAMSkvPDDY4Xk%2FPEoVGpNA43h8vj9WElwQCfj43ABvYg0WGQ%2FhIAC8bCQAGpDgBuFGMCgOCAoVhuWgAKiQAGFWGsjPYkPhWKFwms4DBkBhOOs9OoyFBOKIkNTaMSaCxsQBaShEmjqBAYGDqNYQIkAX2I4IAzAAmb6%2FXiGwHKVT6ME4M1QmE2o3wpHE%2FWOjHY1h4wnEkCk8mUpA0%2BmM9bZOys9mcpDc3n84QaYWi8WSjwypDyxVIZWq9X8bXTcjRtLmFYObwgPVXbxuAA%2BNaLrVL3guX0uABZqzMGAAVADyABFewAuJC7H4yficAShAIaJBWMBJySscf4ZCccLqRm8NjK1YgiBssD3PY%2BXbTWY8PZQFmHiJWQqeECXKueJBkRb8ITsJJ%2BVcrrQ%2BGZcNTBLd9PxDVhIhgFRGBfS5pFYdQTwwJJFx%2BBBcHuXAIzQURbCgXUHWNY5TSNFtPFCAArCBAWEa13ltNh7UYt0EWIRE6AYNB8EWEF%2BHUCQmBUWVQhXKQoBXBBIHDHxwyMZAIDsaBeSPaQ1yQNAfB8XR9EMYwPFdY0MGnLF0wVKVuis9xZk4gBBbsADJuw8esAEl3lsJAtRoNA7HeVgnDYS11RXEA9DQHCkG7DTOBkLZBQMIw%2BFuXiYFXEA%2BDEAIoEOZVWAfVL0wEfYBExHBbEs0qkAcAAiUiCk4gBSABtHwAF0Ela1h2vcetus6mhWo67yAB0wFGjBassgpasEYRIBoZqWp6rqWt4DBev69bME6gbvOm6ykBHHbNqQWrcXUWqapM0JEiQFbeouxyrpqykZo8E6Rtq%2B5rocBFAwYGA5HO9QBAQa6Py2T12x8CRdM0fSkgMSB5B%2BTAcoGOQ%2BENOH0ZAe4wFlEI1AmBAVhAARwewKSPpshhF34EVtP0OmaBcTMlRVNU1lu%2FMjKhP40DNCjqNorSfAYjAmOhAZiKdDiuM0kqbznCBOEQWUDAALwQX90tHIwTy2CBBNKCARLEu5JNJpSarbFhTgACX2fCbySPVHbWOyAFl%2BzYCYkAAIXUThjjdqBaDmKw7EkmwUnpzTtMYIDeY002hIt3KrfwGFsnaRRhHMqKJYDlZ5pEJDVOQZRwdHKSZNDYLcrpAAFABVNApVmUva71vvo04WQwC0eF8ofCdEE5RBG9OCdOCgFZ2BUHltmjA5TkZcMYPUQ8kBCCAEFCH5ff7SyBekadObYNABBq%2Bq%2FgKYbBoG8bJsO6zatLjxWo2l%2FTvam%2FKabNzqfifo9JIv9dofysidP%2B51MSvQcLde6j1zq4hen9d6R0vpPV%2BjVdiR0OaWWzDzS%2BoR%2BbyxNMLciVYxZPjAKESSh8pYyxYtLNiKROJKwtmsZUwNq6aVYHXeUWYED3EyiCfWPxeGjyQKEUO3JD7qWQMqNAMBVCrBxBkMUyoJGYA0FVW%2B98GpIGfpAx6QCYHdDmt%2BFgrVlCbQsT1axBQTo9XQZgt6CdrK4POvg%2F6qDHFPSQfKKkDB1YaJWAIgOoMBDXXVmATAW4cBNxasE6RhtjjgHuOZd8oc77gyEOocMmVowwAED4ZG%2FJMAbiZoyXJZACmaV4nFHJjAMByCgBQBQE4PxxRAcQjwpDcysHzOMSYrwkkEwyCsRxaopKeFIp4cEngbDsHAGCaZhNyZnDzgYHZKw7DOg8L6GqdhCDtzcgAOW7GaH2dkAAasougjLWFc259ynnXzeWcXEdhKHvDhEIv4AJlRCClsC2WaJjSEPcJxX5DhPSECQLUJwAAxTF6L0yHDcAAflRRirFx0cT4h8ASbyrwqHKD%2BGacFnBWFumhVQuFS0xE5jWEipAKK0VYr5di2UuKkAEt5fyzFJLPRkoJDqaYRFWLGhpXAOljKSLsKYgDbhswmlTiQAAJVwOfHA7YFVmSlsajALhWC4nJSQ7muZZQODQIQQghpaw1QFi4NA%2BY%2BgZBBXAT4SLfxuHdTgOELgHA1RVRapFLhcRRvDQiNwPKnBkFTRQEVKa00kocDGuNiaUgX0VWaDcUbmJy3lU6JACK7Wco9RGnN4JzXhspHGxtHZo2Ju5YStNPb03dt7am7NubAkuA5pSi8QMwBQ1VGAKSt4pwzl2HwPk0hRD8kSdgUoRhYI%2BC3JANcQETbflkL%2BCIrAYnq2nLOTQg8R4%2FHuKHCe%2BBMpyo4QqlcCy1BLNpUaOAJ53glNLcyitQrkSGWpRUsykrvSnNJI6yDKA2C1nrPBu%2BiHE1s1%2BQAPwbfLFw9Rr5NAQJhmtmkKnakDLSeZW4v2kUNMmV9wLqOLNIgCP90kMCAZhXactEJYUnPcNxsjd8PRehtbByN6i0NIaQHWGqUnUC4p8d0bDuGgWQnw0M9wRGSMcuExRoMzHaOgoQhKWVXZooHuQP%2BjQUlWSLEEmeRSGtkBDgcBZuYAB1OyuqkDnC0YaV9TE5grjsn8du2zZnnE8F5nzngwABDQKWpwaq3THKrS6alMySpoAfNiNF5xaiFeK7UTMF8MC1FNeGAAemcNwjlNLZf2FYMrVCPhVaQA1roDWDlgByy14kQVHLYiw71%2FrmZwzDaQKNpruXMxBVxNiAFxJ2s1mxBVzrZxMztexMg6gKBEOUDcIKvb3KUUAHYtOIqCrVirbqPiArfT8ELGAwtwAi718mZoEtQD4Ml1Lxp0tgd40xMbzWzIFdqFD6HpXMsgY27tmrdXNtg7m3Dp70hqCI8291xrhNxuDc6yN1HA2aCTeJ7N0nZw8RLe29QNb0hKtdbp6a9rB3kg4tO86pAeojuZmu0gW79RZOY%2B9RZz7cyP00f0sQLLhzPCKs8C7MAi44BUQQA4KhssWUuGBzQCDIm2DWuvlQ%2BMQoRRil20i6rUmXCOX%2Bjbipo7nW85%2BaRhwZvEyiAO7zlw1XUPc494KL3jlffEJlakkqmzdc6iAAAA%22%2C%22compiler%22%3A%22armhfg482%22%2C%22options%22%3A%22-xc%20-std%3Dgnu99%20-Wall%20-pedantic%20-Wextra%20-fverbose-asm%20%20-O3%20-march%3Darmv7%22%7D%5D%7D" rel="nofollow noreferrer">ARMv7: <code>gcc 4.8 -O3 -mcpu=cortex-a15 -fverbose-asm</code> output for adds32</a>:</p>

<pre><code>    adds    r0, r0, r1      @ c, a, b
    it      cs
    movcs   r0, #-1         @ conditional-move
    bx      lr
</code></pre>

<p>16bit: still doesn't use ARM's unsigned-saturating add instruction (<code>UADD16</code>)</p>

<pre><code>    add     r1, r1, r0        @ tmp114, a
    movw    r3, #65535      @ tmp116,
    uxth    r1, r1  @ c, tmp114
    cmp     r0, r1    @ a, c
    ite     ls        @
    movls   r0, r1        @,, c
    movhi   r0, r3        @,, tmp116
    bx      lr  @
</code></pre>

                                    </div>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div class="profile-container">
                                            <div class="profile-details-container d-flex align-items-center">
                                                    <div class="asker-name" itemprop="author" itemscope itemtype="https://schema.org/Person">
                                                        <a href="https://stackoverflow.com/users/15416/msalters" target="_blank"><span itemprop="name">MSalters</span></a>
                                                    </div>
                                            </div>
                                        </div>
                                    </div>
                                        <div style="display: none">
                                            <div itemprop="url">https://c.programmingpedia.net/en/knowledge-base/121240/how-to-do-unsigned-saturating-addition-in-c-#answer-0</div>
                                            <div itemprop="upvoteCount">18</div>
                                            <div itemprop="dateCreated">5/17/2019 5:27:49 AM</div>
                                        </div>
                                </div>
                            </div>
                            <br/>
                            <div id="answer-1" class="block-question second-answer" >
                                <div class="container-question">
                                    <h3 id="popular-answer">Popular Answer</h3>
                                    <div >
                                        <p>In plain C:</p>

<pre><code>uint16_t sadd16(uint16_t a, uint16_t b)
    { return (a &gt; 0xFFFF - b) ? 0xFFFF : a + b; }

uint32_t sadd32(uint32_t a, uint32_t b)
    { return (a &gt; 0xFFFFFFFF - b) ? 0xFFFFFFFF : a + b;} 
</code></pre>

<p>which is almost macro-ized and directly conveys the meaning.</p>

                                    </div>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div class="profile-container">
                                            <div class="profile-details-container d-flex align-items-center">
                                                    <div class="asker-name"><a href="https://stackoverflow.com/users/16827/remo-d" target="_blank">Remo.D</a></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <br/>
                    </div>
                </div>
                <div class="text-center mt-5 mb-5">
                    <a href="https://stackoverflow.com/questions/121240" class="btn-only d-inline-block stack-overflow-identity" target="_blank"><i class="fab fa-stack-overflow"></i> View more on Stack Overflow</a>
                </div>
            </div>
            
            <div class="attribution">
                <div>Licensed under: <a href="https://creativecommons.org/licenses/by-sa/3.0/" target="_blank">CC-BY-SA</a> with <a href="https://stackoverflow.blog/2009/06/25/attribution-required/" target="_blank">attribution</a></div>
                <div>Not affiliated with: <a href="https://stackoverflow.com/questions/tagged/dapper" target="_blank">Stack Overflow</a></div>
                
            </div>
        </div>

    </div>
</div>
            
        </div>
    </div>
    <div class="col-aside-right">
        <div class="col-aside-right-inner">
        </div>
    </div>
</div>
<div class="site-footer">
</div>
    
    <a href="#" id="scroll-to-top" class="back-to-top" style="display: inline;">Icon</a>

<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="http://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

<script>
    $(function() {
        $('a').each(function() {
            var a = new RegExp('/' + window.location.host + '/');
            if (!a.test(this.href)) {
                $(this).attr("target", "_blank");
            }
        });

        $("table").addClass("table table-bordered table-hover table-responsive-sm table-striped");
        $("thead").addClass("thead-dark");

        $('aside a').each(function() {
            if ($(this).attr('href') == '/{{page.permalink}}' ||
                $(this).attr('href') == '{{ site.github.url }}/{{page.permalink}}') {
                $(this).addClass('font-weight-bold');
            }
        });
    });
</script>


</body>

<!-- Mirrored from c.programmingpedia.net/en/knowledge-base/121240/how-to-do-unsigned-saturating-addition-in-c- by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 16 Jan 2021 09:23:16 GMT -->
</html>
