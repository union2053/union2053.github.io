<!DOCTYPE HTML>
<html xmlns:og="http://opengraphprotocol.org/schema/" xmlns:fb="http://www.facebook.com/2008/fbml">

<!-- Mirrored from www.c-programming-simple-steps.com/insertion-sort.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 20 Oct 2020 14:33:58 GMT -->
<head><meta http-equiv="content-type" content="text/html; charset=UTF-8"><title>Insertion sort</title><meta name="description" content="Insertion sort algorithm – explained using examples and analysis."><meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1">
    <link href="sd/support-files/A.style.css.pagespeed.cf.J7qGLGG26B.css" rel="stylesheet" type="text/css">
<!-- start: tool_blocks.sbi_html_head -->
<link rel="canonical" href="insertion-sort.html"/>
<meta property="og:site_name" content="C Programming Simple Steps"/>
<meta property="og:title" content="Insertion sort"/>
<meta property="og:description" content="Insertion sort algorithm – explained using examples and analysis."/>
<meta property="og:type" content="article"/>
<meta property="og:url" content="insertion-sort.html"/>
<meta property="og:image" content="images/insertion-sort.png"/>
<meta property="og:image" content="c-programming-fb.png"/>
<script type="text/javascript" language="JavaScript">var https_page=0</script>


    <script src="sd/support-files/eucookie.js.pagespeed.jm.ksMg6Nudeq.js" async defer type="text/javascript"></script><!-- end: tool_blocks.sbi_html_head -->
<!-- start: shared_blocks.2087538#end-of-head -->

<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','http://www.google-analytics.com/analytics.js','ga');ga('create','UA-70996381-1','auto');ga('send','pageview');</script>

<!-- end: shared_blocks.2087538#end-of-head -->
    
    <script type="text/javascript">var FIX=FIX||{};</script>
    
</head>
<body class="responsive">

    <div id="PageWrapper" class="modern">

      <div id="HeaderWrapper">
        <div id="Header">
          <div class="Liner">
            <div class="WebsiteName">
              <a href="index.html"> </a>
            </div><div class="Tagline"> </div>
<!-- start: shared_blocks.2087525#top-of-header -->

<!-- start: tool_blocks.navbar.horizontal.left --><div class="ResponsiveNavWrapper"> 
 		        <div class="ResponsiveNavButton"><span>Menu</span></div><div class="HorizontalNavBarLeft HorizontalNavBar HorizontalNavBarCSS ResponsiveNav"> 
 	
                <ul class="root"><li class="li1"><a href="index.html">Home</a></li><li class="li1"><a href="online-computer-programming-courses.html">Courses</a></li><li class="li1 submenu">
                            <span class="navheader">Tutorials</span><ul><li class="li2"><a href="programming-for-beginners.html">Beginners</a></li><li class="li2"><a href="c-programming-tutorial.html">C Tutorial</a></li><li class="li2"><a href="number-systems.html">Number Systems</a></li></ul></li><li class="li1 submenu">
                            <span class="navheader">C</span><ul><li class="li2"><a href="c-language-programming.html">C Language</a></li><li class="li2"><a href="c-keywords.html">C Keywords</a></li></ul></li><li class="li1 submenu">
                            <span class="navheader">Algorithms</span><ul><li class="li2"><a href="algorithms.html">Algorithms</a></li><li class="li2"><a href="sorting-algorithms.html">Sorting algorithms</a></li></ul></li><li class="li1 submenu">
                            <span class="navheader">General</span><ul><li class="li2"><a href="computer-programming.html">Computer Programming</a></li><li class="li2"><a href="c-programming-examples.html">Examples Download</a></li></ul></li><li class="li1 submenu">
                            <span class="navheader">About</span><ul><li class="li2"><a href="contact-me.html">Contact me</a></li><li class="li2"><a href="privacy-policy.html">Privacy Policy</a></li></ul></li></ul>
            </div></div><!-- end: tool_blocks.navbar.horizontal.left -->
<div id="google_custom_search">
<script>(function(){var cx='004800009253881390622:5z6xrveedtw';var gcse=document.createElement('script');gcse.type='text/javascript';gcse.async=true;gcse.src='https://cse.google.com/cse.js?cx='+cx;var s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(gcse,s);})();</script>
<gcse:search></gcse:search>
</div>

<!-- end: shared_blocks.2087525#top-of-header -->
<!-- start: shared_blocks.2087491#bottom-of-header -->


<!-- end: shared_blocks.2087491#bottom-of-header -->
</div><!-- end Liner -->
        </div><!-- end Header -->
      </div><!-- end HeaderWrapper -->

      <div id="ContentWrapper">
        <div id="ContentColumn">
          <div class="Liner">
<!-- start: shared_blocks.2087484#above-h1 -->


<!-- end: shared_blocks.2087484#above-h1 -->
<h1>Insertion sort</h1>
<!-- start: shared_blocks.2087549#below-h1 -->


<!-- end: shared_blocks.2087549#below-h1 -->
<h3>Background</h3>
&nbsp;&nbsp;&nbsp;&nbsp;Insertion sort is one of the most efficient among the O(n<sup>2</sup>) sorting algorithms. It has a worst and average time complexity of O(n<sup>2</sup>). Its best case is when the input is already sorted. This results in linear complexity O(n). It is stable and adaptive. It is one of the most efficient algorithms for sorting a small data set. For that reason, some divide-and-conquer algorithms use it in their final phase, when the input is divided to smaller parts ( 0 < n < 10 to 20).
<!-- start: shared_blocks.2087535#below-paragraph-1 -->

<!-- start: shared_blocks.203349160#Course CFB regular -->

<div class="" style="border-color: #000000; border-width: 1px 0 1px 0; border-style: solid; width: 80%; box-sizing: border-box"><div style="overflow-x: auto;">
    <table class="columns_block grid_block" border="0" style="width: 100%;"><tr><td class="column_0" style="width: 50%;vertical-align:top;">
<h4>Do you learn better from video?<br/></h4>
<p style="text-align: left;">Learn faster with deeper understanding!<br/> The "Computer programming for beginners" course is the perfect place to begin with programming.</p><p style="text-align: left;"><a href="https://www.udemy.com/course/computer-programming-for-beginners-understand-how-it-works/?referralCode=9BDA1D56B5E98D9C04F0" onclick="return FIX.track(this);"> Start now!</a><br/></p>
</td><td class="column_1" style="width: 50%;vertical-align:top;">
<div class="ImageBlock ImageBlockCenter"><a href="https://www.udemy.com/course/computer-programming-for-beginners-understand-how-it-works/?referralCode=9BDA1D56B5E98D9C04F0" onclick="return FIX.track(this);"><img src="images/345xNxcourse-programming-for-beginners.png.pagespeed.ic.Ie6U_Nc1V2.png" width="345" data-pin-media="images/course-programming-for-beginners.png"></a></div>
</td></tr></table>
</div>
</div>
<!-- end: shared_blocks.203349160#Course CFB regular -->

<!-- end: shared_blocks.2087535#below-paragraph-1 -->
<p>&#xa0; &#xa0; It has one interesting and very rare feature – it is “online”. This means that the array (or list) can arrive one item at a time and still be sorted correctly. This is very useful if we want to add new elements to an already sorted array.</p>
<h3>Algorithm</h3>
<p>&#xa0; &#xa0; Insertion sort makes n-1 passes. Unlike the <a href="bubble-sort.html" onclick="return FIX.track(this);">bubble sort</a> and the <a href="selection-sort.html" onclick="return FIX.track(this);">selection sort</a>, the pass is done through the sorted part of the array. The first pass takes the second element. It is compared to the first element.<br/> - If they are in the correct order – we can continue with the next pass.<br/> - If they are in the wrong order, the value of the second element is saved in a temporary variable, then the first element is shifted to second position and the saved value in the temporary variable is written in first position.</p><p>&#xa0; &#xa0; Now the first two elements are sorted in relation to each other. The second pass takes the third element and compares it to the second.<br/> - If they are in the correct order – continue with the next pass.<br/> - If they are in the wrong order we continue to compare the current element(the third) with the previous elements until we find its correct place. Then we save the current value, shift all elements that need to be after it and insert the element to its correct location.&#xa0;</p><p>This repeats until all numbers are inserted to their correct place.</p><p>As always, we will make a detailed example to apply the new algorithm:</p>
<h3>Example</h3>
<p>&#xa0; &#xa0; Sort the numbers ( -3, 4, 0, 15, 7, 1) using insertion sort. In this example, the <b>bold</b> numbers are the ones that we are inserting the current step.</p><p>Pass 1: -3, <span style="text-decoration: none;"><b>4</b></span>, 0, 15, 7, 1<br/>&#xa0;1. 4 &lt; -3? No</p><p>Pass 2: -3, 4, <span style="text-decoration: none;"><b>0</b></span>, 15, 7, 1<br/>&#xa0;1. 0 &lt; 4? Yes<br/>&#xa0;2. 0 &lt; -3? No =&gt; Shift 4, Move 0.</p><p>Pass 3: -3, 0, 4, <span style="text-decoration: none;"><b>15</b></span>, 7, 1<br/>&#xa0;1. 15 &lt; 4? No</p><p>Pass 4: -3, 0, 4, 15, <span style="text-decoration: none;"><b>7</b></span>, 1<br/>&#xa0;1. 7 &lt; 15? Yes<br/>&#xa0;2. 7 &lt; 4? No =&gt; Shift 15, Move 7</p><p>Pass 5: -3, 0, 4, 7, 15, <span style="text-decoration: none;"><b>1</b></span><br/>&#xa0;1. 1 &lt; 15? Yes<br/>&#xa0;2. 1 &lt; 7? Yes<br/>&#xa0;3. 1 &lt; 4? Yes<br/>&#xa0;4. 1 &lt; 0? No =&gt; Shift 4, 7, 15, Move 1</p><p>-3, 0, 1, 4, 7, 15</p><p>&#xa0; &#xa0; As seen (in pass 3), the algorithm very easily recognizes if the element is already in the correct place. This means it is adaptive and its best case completes in linear time O(n) if the input data comes sorted. In this case there would be n comparisons and 0 swaps/shifts.</p>
<h3>Implementation</h3>
<p>&#xa0; &#xa0; For the implementation of insertion sort we need two loops. The first will iterate through the unsorted part of the array. For each unsorted element the second loop will go through the sorted part and search for its correct location. This means that we need to nest the second loop into the first. After we find the correct place to insert the current element, we need to shift all remaining elements. For that purpose we need one more loop.</p><p>&#xa0; &#xa0; <em>*A simpler implementation exists that uses swaps instead of insertion and shifts. It could be useful when swapping is fast(if the elements are integer numbers), but it becomes very slow if we need to swap objects.</em></p>
<div class="ImageBlock ImageBlockCenter"><img src="images/insertion-sort.png.pagespeed.ce.LngtAdSIAd.png" width="553" alt="Insertion sort flow chart" title="Insertion sort flow chart" data-pin-media="images/insertion-sort.png"></div>
&nbsp;&nbsp;&nbsp;&nbsp;How much time the insertion sort costs?
If “n” is the total number of elements and “m” is the number of sorted elements in the current pass.
For each of the “n” passes it makes makes:
 - on average m/2 comparisons. In the worst case this will be equal to n/2. So we have (n passes) * (n / 2) comparisons. => O(n<sup>2</sup>) comparisons.
 - m / 2 number of shifts, in the worst case – n /2. => O(n<sup>2</sup>) shifts.
<p>&nbsp;&nbsp;&nbsp;&nbsp;As you see, the number of actions are divided by the factor of 2. At the same time the algorithm is adaptive (it takes advantage of pre-sorted elements) and has better average efficiency then bubble sort and selection sort.
But still – in the worst case both comparisons and shifts have O(n<sup>2</sup>). This doesn't look too efficient, does it?
Can we optimize this? Let's see...
<h3>Reducing the comparisons</h3>
<b>Binary insertion sort</b>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Since all the comparisons are done in the sorted part of the array, we can use binary search to find the correct place for the current item. Binary search has a time complexity of O(log<sub>2</sub>n), which is really better than linear search. This helps to reduce the number of comparisons from n to log<sub>2</sub>n in one pass or n*log<sub>2</sub>n for the whole sorting.
<p>&nbsp;&nbsp;&nbsp;&nbsp;Important! Binary search has logarithmic time complexity only if the access to the elements is constant time. This is the case with normal arrays, where indexing requires indeed constant time.
Other data structures, like linked list will most likely require linear time to access an element at random position. In this case the binary search will go to O(n*log<sub>2</sub>n), which is worse than linear search.
<h3>Reducing the shifts/swaps</h3>
<p><b>Sorting linked list</b></p><p>&#xa0; &#xa0; We have just mentioned that data structures like linked lists can't benefit from binary search to reduce the number of comparisons. This is because of their structure. The question here is - “Can we use their structure to our advantage?”. The answer is “Yes”.</p><p>&#xa0; &#xa0; Linked lists use pointers to access the next element. This makes it very easy make a real insertion of the element to its correct place. After we found the correct place for the current item, we just need to insert it to the right place and remove it from the old place. That's all, no shifting is needed.</p><p>&#xa0; &#xa0; This reduces the shifting/swapping time from linear to constant! So in result, when sorting linked lists we have only O(n) swapping complexity. However, the comparisons still have that quadratic count.</p>
&nbsp;&nbsp;&nbsp;&nbsp;Note that there are data structures that provide both fast insertion and random item access in constant time. This combines the two optimizations. For such structures insertion sort has O(n * log<sub>2</sub>n) time complexity and still O(1) space complexity! Such data types are for example skip lists, or modified linked lists. The latter uses a pair of two pointers(one to the value, and one to the next element) instead of a value and a pointer.
<p><b>Library sort (Gapped insertion sort)</b></p><p>&#xa0; &#xa0; What was the main problem with insertion sort, when sorting an array? Yup, the high number of shifts or swaps that we need to do every time we insert a new element.</p><p>&#xa0; &#xa0; Library sort is a successful attempt to correct this problem. It makes a “normalization” to the sorted elements, by making gaps between them. The gaps are empty elements. When we insert the next item, we don't need to shift.</p><p>&#xa0; &#xa0; After every insertion, the normalization is repeated, so that we can use the fast insertion again.</p><p>&#xa0; &#xa0; The computations to prove the complexity here are rather complex ;-), but if you are interested, look here: <a href="http://qmcd09.physics.wustl.edu/Presentations/qmcd09Talks/mbender-APMA-QMCD09.pdf" target="_blank" onclick="return FIX.track(this);">presentation about library sort</a> and also here: <a href="http://www.cs.sunysb.edu/~bender/newpub/BenderFaMo06-librarysort.pdf" target="_blank" onclick="return FIX.track(this);">analysis and explanation of library sort</a>.</p>
&nbsp;&nbsp;&nbsp;&nbsp;In conclusion: The overall cost of library sort is O(n * log<sub>2</sub>n) with high probability. Note that it requires additional space for the gaps.
<h3>Summary</h3>
<p>Insertion sort:
<br> - is stable
<br> - is adaptive
<br> - is online - can sort the data as it receives it
<br> - is easy to implement
<br> - has constant space complexity O(1)
<br> - is one of the most efficient algorithms to sort a small number of items
<br> - can be optimized to do only n*log<sub>2</sub>n comparisons if access time is constant
<br> - can be optimized to do only “n” swaps when sorting data structures like linked list
<br> - can run in O(n*log<sub>2</sub>n) time if applied to specific data structures
<br> - is a base for library sort, which can run in O(n*log<sub>2</sub>n) time complexity
<br> - is used in practice to complement algorithms like quicksort, shell sort
</p>
<!-- start: shared_blocks.2087532#above-socialize-it -->

<!-- start: shared_blocks.203349160#Course CFB regular -->

<div class="" style="border-color: #000000; border-width: 1px 0 1px 0; border-style: solid; width: 80%; box-sizing: border-box"><div style="overflow-x: auto;">
    <table class="columns_block grid_block" border="0" style="width: 100%;"><tr><td class="column_0" style="width: 50%;vertical-align:top;">
<h4>Do you learn better from video?<br/></h4>
<p style="text-align: left;">Learn faster with deeper understanding!<br/> The "Computer programming for beginners" course is the perfect place to begin with programming.</p><p style="text-align: left;"><a href="https://www.udemy.com/course/computer-programming-for-beginners-understand-how-it-works/?referralCode=9BDA1D56B5E98D9C04F0" onclick="return FIX.track(this);"> Start now!</a><br/></p>
</td><td class="column_1" style="width: 50%;vertical-align:top;">
<div class="ImageBlock ImageBlockCenter"><a href="https://www.udemy.com/course/computer-programming-for-beginners-understand-how-it-works/?referralCode=9BDA1D56B5E98D9C04F0" onclick="return FIX.track(this);"><img src="images/345xNxcourse-programming-for-beginners.png.pagespeed.ic.Ie6U_Nc1V2.png" width="345" data-pin-media="images/course-programming-for-beginners.png"></a></div>
</td></tr></table>
</div>
</div>
<!-- end: shared_blocks.203349160#Course CFB regular -->

<!-- end: shared_blocks.2087532#above-socialize-it -->
<br>
<span itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
 <a href="index.html" itemprop="url">
<span itemprop="title">C Programming</span></a>

</span>

 ›

<span itemprop="child" itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
 <a href="sorting-algorithms.html" itemprop="url">
<span itemprop="title">Sorting Algorithms</span></a>
</span>

 › Insertion sort
<!-- start: shared_blocks.2087488#socialize-it -->


<div class="" style="border-color: #000000; border-width: 1px 0 1px 0; border-style: solid; width: 100%; box-sizing: border-box">
<div class="desktopOnly"><div class="" style="width: 50%; box-sizing: border-box"><div style="overflow-x: auto;">
    <table class="columns_block grid_block" border="0" style="width: 100%;"><tr><td class="column_0" style="width: 53%;vertical-align:top;">
<p>Did this help? Support me with your vote ;-)</p>
</td><td class="column_1" style="width: 22.42%;vertical-align:top;">

<div class="" style="padding-top: 5px; box-sizing: border-box"><!-- start: tool_blocks.faceit_like.1 --><div class="fb-like" data-href="http://www.c-programming-simple-steps.com/insertion-sort.html" data-layout="button_count" data-action="like" data-show-faces="false" data-share="false"></div><!-- end: tool_blocks.faceit_like.1 -->
</div>
</td><td class="column_2" style="width: 24.29%;vertical-align:top;">

<div class="" style="margin-left: auto; margin-right: auto; padding-top: 13px; float: none; box-sizing: border-box"><!-- start: tool_blocks.googleplus1 -->
        <div class="googlePlusOne" style="text-align:center">
          <div class="g-plusone" data-size="standard" data-annotation="bubble" data-href="http://www.c-programming-simple-steps.com/insertion-sort.html" data-callback="plusone_vote">
          </div>
        </div>
        <!-- end: tool_blocks.googleplus1 -->
</div>
</td></tr></table>
</div>
</div></div>

<div class="mobileOnly"><div style="overflow-x: auto;">
    <table class="columns_block grid_block" border="0" style="width: 100%;"><tr><td class="column_0" style="width: 39.991%;vertical-align:top;">
<p>Did this help?<br/></p>
</td><td class="column_1" style="width: 29.989%;vertical-align:top;">

<div class="" style="padding-top: 5px; box-sizing: border-box"><!-- start: tool_blocks.faceit_like.1 --><div class="fb-like" data-href="http://www.c-programming-simple-steps.com/insertion-sort.html" data-layout="button_count" data-action="like" data-show-faces="false" data-share="false"></div><!-- end: tool_blocks.faceit_like.1 -->
</div>
</td><td class="column_2" style="width: 30%;vertical-align:top;">

<div class="" style="padding-top: 13px; box-sizing: border-box"><!-- start: tool_blocks.googleplus1 -->
        <div class="googlePlusOne" style="text-align:center">
          <div class="g-plusone" data-size="standard" data-annotation="bubble" data-href="http://www.c-programming-simple-steps.com/insertion-sort.html" data-callback="plusone_vote">
          </div>
        </div>
        <!-- end: tool_blocks.googleplus1 -->
</div>
</td></tr></table>
</div>
</div>
</div>

<!-- end: shared_blocks.2087488#socialize-it -->
<!-- start: shared_blocks.2087520#below-socialize-it -->

<div id="disqus_thread"></div>
<script>(function(){var d=document,s=d.createElement('script');s.src='http://c-programming-simple-steps.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

<!-- end: shared_blocks.2087520#below-socialize-it -->
</div><!-- end Liner -->
        </div><!-- end ContentColumn -->
      </div><!-- end ContentWrapper -->

      <div id="FooterWrapper">
        <div id="Footer">
          <div class="Liner">
<!-- start: shared_blocks.2087493#above-bottom-nav -->

<!-- Share Desktop -->
<script type="text/javascript" src="http://s7.addthis.com/js/300/addthis_widget.js#pubid=ra-564f710f0b9c248f" async="async"></script>
<!-- Share Mobile -->
<script type="text/javascript" src="http://s7.addthis.com/js/300/addthis_widget.js#pubid=ra-564f710f0b9c248f" async="async"></script>

<!-- end: shared_blocks.2087493#above-bottom-nav -->
<!-- start: shared_blocks.2087504#bottom-navigation -->


<!-- end: shared_blocks.2087504#bottom-navigation -->
<!-- start: shared_blocks.2087486#below-bottom-nav -->


<!-- end: shared_blocks.2087486#below-bottom-nav -->
<!-- start: shared_blocks.2087501#footer -->

<p><a href="index.html">© Copyright 2008-2016 c-programming-simple-steps.com</a><br/></p>

<!-- end: shared_blocks.2087501#footer -->
</div><!-- end Liner -->
        </div><!-- end Footer -->
      </div><!-- end FooterWrapper -->

    </div><!-- end PageWrapper -->

    
    <script type="text/javascript" src="sd/support-files/fix.js.pagespeed.jm.3phKUrh9Pj.js"></script>
    
    <script type="text/javascript">FIX.doEndOfBody();</script>
    <script type="text/javascript" src="sd/support-files/design.js.pagespeed.jm.IGpaLo39T1.js"></script>
<!-- start: tool_blocks.sbi_html_body_end -->
    <script>var SS_PARAMS={pinterest_enabled:false,googleplus1_on_page:true,socializeit_onpage:false};</script>            <div id="fb-root"></div>
            <script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v4.0&autoLogAppEvents=1"></script><style>.g-recaptcha{display:inline-block}.recaptcha_wrapper{text-align:center}</style>
	    <script>if(typeof recaptcha_callbackings!=="undefined"){SS_PARAMS.recaptcha_callbackings=recaptcha_callbackings||[]};</script>
	    
  <script>(function(d,id){if(d.getElementById(id)){return;}var s=d.createElement('script');s.async=true;s.defer=true;s.src="ssjs/ldr.js";s.id=id;d.getElementsByTagName('head')[0].appendChild(s);})(document,'_ss_ldr_script');</script><!-- end: tool_blocks.sbi_html_body_end -->
  
<!-- Generated at 13:14:33 07-Nov-2019 -->

</body>

<!-- Mirrored from www.c-programming-simple-steps.com/insertion-sort.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 20 Oct 2020 14:34:00 GMT -->
</html>
